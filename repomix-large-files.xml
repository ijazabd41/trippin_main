This file is a merged representation of a subset of the codebase, containing specifically included files, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Only files matching these patterns are included: **/TripDetail.tsx, **/ChatBot.tsx, **/apiMockData.ts, **/DetailedPreferences.tsx, **/Confirmation.tsx
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
src/
  components/
    questionnaire/
      Confirmation.tsx
      DetailedPreferences.tsx
  pages/
    ChatBot.tsx
    TripDetail.tsx
  utils/
    apiMockData.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="src/pages/ChatBot.tsx">
import React, { useState, useEffect, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { Send, Bot, User, MapPin, Phone, Languages as Translate, Camera, Book, Loader } from 'lucide-react';
import { useLanguage } from '../contexts/LanguageContext';
import { apiCall, API_CONFIG, APIError } from '../config/api';
import { handleAWSError, globalErrorHandler } from '../utils/errorHandler';
import MockDataNotice from '../components/MockDataNotice';

interface Message {
  id: string;
  type: 'user' | 'bot';
  content: string;
  timestamp: string;
  actions?: Array<{
    label: string;
    action: () => void;
  }>;
}

const ChatBot: React.FC = () => {
  const { t, currentLanguage } = useLanguage();
  const [messages, setMessages] = useState<Message[]>([]);
  const [inputMessage, setInputMessage] = useState('');
  const [isTyping, setIsTyping] = useState(false);
  const [isError, setIsError] = useState(false);
  const [showMockNotice, setShowMockNotice] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  // Multilingual content
  const getLocalizedContent = () => {
    switch (currentLanguage) {
      case 'en':
        return {
          title: 'AI Chat Assistant',
          subtitle: '24/7 support anytime',
          quickActions: 'Quick Actions',
          emergency: 'Emergency Contacts',
          translation: 'Translation',
          nearby: 'Nearby Info',
          weather: 'Weather Info',
          helpCenter: 'Help Center',
          inputPlaceholder: 'Type a message...',
          emergencyContent: `ğŸš¨ Emergency Contacts

Police: 110
Fire/Ambulance: 119
Tourist Hotline: 050-3816-2787

When reporting your location, please check nearby landmarks or addresses.`,
          translationContent: 'Translation features are available. Text translation, voice translation, and photo translation are possible.',
          nearbyContent: 'You can search for tourist attractions, restaurants, and transportation around your current location.',
          weatherContent: `ğŸŒ¤ï¸ Today's Weather Information

Tokyo: Sunny, 22Â°C
Osaka: Cloudy, 20Â°C
Kyoto: Sunny, 21Â°C

â€»Please check the Japan Meteorological Agency website for the latest weather information.`,
          greeting: 'Hello! Ask me anything about traveling in Japan.'
        };
      case 'zh':
        return {
          title: 'AIèŠå¤©åŠ©æ‰‹',
          subtitle: '24å°æ—¶éšæ—¶ä¸ºæ‚¨æœåŠ¡',
          quickActions: 'å¿«é€Ÿæ“ä½œ',
          emergency: 'ç´§æ€¥è”ç³»æ–¹å¼',
          translation: 'ç¿»è¯‘',
          nearby: 'å‘¨è¾¹ä¿¡æ¯',
          weather: 'å¤©æ°”ä¿¡æ¯',
          helpCenter: 'å¸®åŠ©ä¸­å¿ƒ',
          inputPlaceholder: 'è¾“å…¥æ¶ˆæ¯...',
          emergencyContent: `ğŸš¨ ç´§æ€¥è”ç³»æ–¹å¼

è­¦å¯Ÿ: 110
æ¶ˆé˜²/æ€¥æ•‘: 119
æ—…æ¸¸çƒ­çº¿: 050-3816-2787

æŠ¥å‘Šä½ç½®æ—¶ï¼Œè¯·ç¡®è®¤é™„è¿‘çš„åœ°æ ‡æˆ–åœ°å€ã€‚`,
          translationContent: 'å¯ä»¥ä½¿ç”¨ç¿»è¯‘åŠŸèƒ½ã€‚æ”¯æŒæ–‡æœ¬ç¿»è¯‘ã€è¯­éŸ³ç¿»è¯‘å’Œç…§ç‰‡ç¿»è¯‘ã€‚',
          nearbyContent: 'å¯ä»¥æœç´¢å½“å‰ä½ç½®å‘¨å›´çš„æ—…æ¸¸æ™¯ç‚¹ã€é¤å…å’Œäº¤é€šå·¥å…·ã€‚',
          weatherContent: `ğŸŒ¤ï¸ ä»Šæ—¥å¤©æ°”ä¿¡æ¯

ä¸œäº¬: æ™´å¤©ï¼Œ22Â°C
å¤§é˜ª: å¤šäº‘ï¼Œ20Â°C
äº¬éƒ½: æ™´å¤©ï¼Œ21Â°C

â€»è¯·æŸ¥çœ‹æ—¥æœ¬æ°”è±¡å…ç½‘ç«™è·å–æœ€æ–°å¤©æ°”ä¿¡æ¯ã€‚`,
          greeting: 'æ‚¨å¥½ï¼è¯·éšæ—¶è¯¢é—®å…³äºæ—¥æœ¬æ—…è¡Œçš„ä»»ä½•é—®é¢˜ã€‚'
        };
      case 'ko':
        return {
          title: 'AI ì±„íŒ… ì–´ì‹œìŠ¤í„´íŠ¸',
          subtitle: '24ì‹œê°„ ì–¸ì œë“ ì§€ ì§€ì›',
          quickActions: 'ë¹ ë¥¸ ì‘ì—…',
          emergency: 'ê¸´ê¸‰ ì—°ë½ì²˜',
          translation: 'ë²ˆì—­',
          nearby: 'ì£¼ë³€ ì •ë³´',
          weather: 'ë‚ ì”¨ ì •ë³´',
          helpCenter: 'ë„ì›€ë§ ì„¼í„°',
          inputPlaceholder: 'ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...',
          emergencyContent: `ğŸš¨ ê¸´ê¸‰ ì—°ë½ì²˜

ê²½ì°°: 110
ì†Œë°©/ì‘ê¸‰: 119
ê´€ê´‘ í•«ë¼ì¸: 050-3816-2787

ìœ„ì¹˜ë¥¼ ì‹ ê³ í•  ë•ŒëŠ” ì£¼ë³€ ëœë“œë§ˆí¬ë‚˜ ì£¼ì†Œë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.`,
          translationContent: 'ë²ˆì—­ ê¸°ëŠ¥ì„ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í…ìŠ¤íŠ¸ ë²ˆì—­, ìŒì„± ë²ˆì—­, ì‚¬ì§„ ë²ˆì—­ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
          nearbyContent: 'í˜„ì¬ ìœ„ì¹˜ ì£¼ë³€ì˜ ê´€ê´‘ ëª…ì†Œ, ë ˆìŠ¤í† ë‘, êµí†µìˆ˜ë‹¨ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
          weatherContent: `ğŸŒ¤ï¸ ì˜¤ëŠ˜ì˜ ë‚ ì”¨ ì •ë³´

ë„ì¿„: ë§‘ìŒ, 22Â°C
ì˜¤ì‚¬ì¹´: íë¦¼, 20Â°C
êµí† : ë§‘ìŒ, 21Â°C

â€»ìµœì‹  ë‚ ì”¨ ì •ë³´ëŠ” ì¼ë³¸ ê¸°ìƒì²­ ì›¹ì‚¬ì´íŠ¸ì—ì„œ í™•ì¸í•˜ì„¸ìš”.`,
          greeting: 'ì•ˆë…•í•˜ì„¸ìš”! ì¼ë³¸ ì—¬í–‰ì— ëŒ€í•´ ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”.'
        };
      case 'es':
        return {
          title: 'Asistente de Chat IA',
          subtitle: 'Soporte 24/7 en cualquier momento',
          quickActions: 'Acciones RÃ¡pidas',
          emergency: 'Contactos de Emergencia',
          translation: 'TraducciÃ³n',
          nearby: 'InformaciÃ³n Cercana',
          weather: 'InformaciÃ³n del Clima',
          helpCenter: 'Centro de Ayuda',
          inputPlaceholder: 'Escribe un mensaje...',
          emergencyContent: `ğŸš¨ Contactos de Emergencia

PolicÃ­a: 110
Bomberos/Ambulancia: 119
LÃ­nea TurÃ­stica: 050-3816-2787

Al reportar tu ubicaciÃ³n, verifica puntos de referencia o direcciones cercanas.`,
          translationContent: 'Las funciones de traducciÃ³n estÃ¡n disponibles. Es posible traducciÃ³n de texto, voz y fotos.',
          nearbyContent: 'Puedes buscar atracciones turÃ­sticas, restaurantes y transporte alrededor de tu ubicaciÃ³n actual.',
          weatherContent: `ğŸŒ¤ï¸ InformaciÃ³n del Clima de Hoy

Tokio: Soleado, 22Â°C
Osaka: Nublado, 20Â°C
Kioto: Soleado, 21Â°C

â€»Consulta el sitio web de la Agencia MeteorolÃ³gica de JapÃ³n para informaciÃ³n actualizada.`,
          greeting: 'Â¡Hola! PregÃºntame cualquier cosa sobre viajar a JapÃ³n.'
        };
      case 'fr':
        return {
          title: 'Assistant de Chat IA',
          subtitle: 'Support 24/7 Ã  tout moment',
          quickActions: 'Actions Rapides',
          emergency: 'Contacts d\'Urgence',
          translation: 'Traduction',
          nearby: 'Infos ProximitÃ©',
          weather: 'Infos MÃ©tÃ©o',
          helpCenter: 'Centre d\'Aide',
          inputPlaceholder: 'Tapez un message...',
          emergencyContent: `ğŸš¨ Contacts d'Urgence

Police: 110
Pompiers/Ambulance: 119
Ligne Touristique: 050-3816-2787

Lors du signalement de votre position, vÃ©rifiez les points de repÃ¨re ou adresses Ã  proximitÃ©.`,
          translationContent: 'Les fonctions de traduction sont disponibles. Traduction de texte, vocale et photo possible.',
          nearbyContent: 'Vous pouvez rechercher des attractions touristiques, restaurants et transports autour de votre position.',
          weatherContent: `ğŸŒ¤ï¸ Informations MÃ©tÃ©o d'Aujourd'hui

Tokyo: EnsoleillÃ©, 22Â°C
Osaka: Nuageux, 20Â°C
Kyoto: EnsoleillÃ©, 21Â°C

â€»Consultez le site de l'Agence MÃ©tÃ©orologique du Japon pour les derniÃ¨res informations.`,
          greeting: 'Bonjour! Demandez-moi n\'importe quoi sur les voyages au Japon.'
        };
      case 'hi':
        return {
          title: 'AI à¤šà¥ˆà¤Ÿ à¤…à¤¸à¤¿à¤¸à¥à¤Ÿà¥‡à¤‚à¤Ÿ',
          subtitle: '24/7 à¤•à¤­à¥€ à¤­à¥€ à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾',
          quickActions: 'à¤¤à¥à¤µà¤°à¤¿à¤¤ à¤•à¤¾à¤°à¥à¤¯',
          emergency: 'à¤†à¤ªà¤¾à¤¤à¤•à¤¾à¤²à¥€à¤¨ à¤¸à¤‚à¤ªà¤°à¥à¤•',
          translation: 'à¤…à¤¨à¥à¤µà¤¾à¤¦',
          nearby: 'à¤†à¤¸à¤ªà¤¾à¤¸ à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€',
          weather: 'à¤®à¥Œà¤¸à¤® à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€',
          helpCenter: 'à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾ à¤•à¥‡à¤‚à¤¦à¥à¤°',
          inputPlaceholder: 'à¤¸à¤‚à¤¦à¥‡à¤¶ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¥‡à¤‚...',
          emergencyContent: `ğŸš¨ à¤†à¤ªà¤¾à¤¤à¤•à¤¾à¤²à¥€à¤¨ à¤¸à¤‚à¤ªà¤°à¥à¤•

à¤ªà¥à¤²à¤¿à¤¸: 110
à¤…à¤—à¥à¤¨à¤¿à¤¶à¤®à¤¨/à¤à¤®à¥à¤¬à¥à¤²à¥‡à¤‚à¤¸: 119
à¤ªà¤°à¥à¤¯à¤Ÿà¤• à¤¹à¥‰à¤Ÿà¤²à¤¾à¤‡à¤¨: 050-3816-2787

à¤…à¤ªà¤¨à¤¾ à¤¸à¥à¤¥à¤¾à¤¨ à¤¬à¤¤à¤¾à¤¤à¥‡ à¤¸à¤®à¤¯, à¤†à¤¸à¤ªà¤¾à¤¸ à¤•à¥‡ à¤¸à¥à¤¥à¤²à¤šà¤¿à¤¹à¥à¤¨ à¤¯à¤¾ à¤ªà¤¤à¥‡ à¤•à¥€ à¤œà¤¾à¤‚à¤š à¤•à¤°à¥‡à¤‚à¥¤`,
          translationContent: 'à¤…à¤¨à¥à¤µà¤¾à¤¦ à¤¸à¥à¤µà¤¿à¤§à¤¾à¤à¤‚ à¤‰à¤ªà¤²à¤¬à¥à¤§ à¤¹à¥ˆà¤‚à¥¤ à¤Ÿà¥‡à¤•à¥à¤¸à¥à¤Ÿ à¤…à¤¨à¥à¤µà¤¾à¤¦, à¤†à¤µà¤¾à¤œ à¤…à¤¨à¥à¤µà¤¾à¤¦ à¤”à¤° à¤«à¥‹à¤Ÿà¥‹ à¤…à¤¨à¥à¤µà¤¾à¤¦ à¤¸à¤‚à¤­à¤µ à¤¹à¥ˆà¥¤',
          nearbyContent: 'à¤†à¤ª à¤…à¤ªà¤¨à¥‡ à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤¸à¥à¤¥à¤¾à¤¨ à¤•à¥‡ à¤†à¤¸à¤ªà¤¾à¤¸ à¤ªà¤°à¥à¤¯à¤Ÿà¤¨ à¤¸à¥à¤¥à¤², à¤°à¥‡à¤¸à¥à¤¤à¤°à¤¾à¤‚ à¤”à¤° à¤ªà¤°à¤¿à¤µà¤¹à¤¨ à¤–à¥‹à¤œ à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤',
          weatherContent: `ğŸŒ¤ï¸ à¤†à¤œ à¤•à¥€ à¤®à¥Œà¤¸à¤® à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€

à¤Ÿà¥‹à¤•à¥à¤¯à¥‹: à¤§à¥‚à¤ª, 22Â°C
à¤“à¤¸à¤¾à¤•à¤¾: à¤¬à¤¾à¤¦à¤², 20Â°C
à¤•à¥à¤¯à¥‹à¤Ÿà¥‹: à¤§à¥‚à¤ª, 21Â°C

â€»à¤¨à¤µà¥€à¤¨à¤¤à¤® à¤®à¥Œà¤¸à¤® à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤•à¥‡ à¤²à¤¿à¤ à¤œà¤¾à¤ªà¤¾à¤¨ à¤®à¥Œà¤¸à¤® à¤µà¤¿à¤œà¥à¤à¤¾à¤¨ à¤à¤œà¥‡à¤‚à¤¸à¥€ à¤•à¥€ à¤µà¥‡à¤¬à¤¸à¤¾à¤‡à¤Ÿ à¤¦à¥‡à¤–à¥‡à¤‚à¥¤`,
          greeting: 'à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤œà¤¾à¤ªà¤¾à¤¨ à¤¯à¤¾à¤¤à¥à¤°à¤¾ à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤•à¥à¤› à¤­à¥€ à¤ªà¥‚à¤›à¥‡à¤‚à¥¤'
        };
      case 'ru':
        return {
          title: 'Ğ˜Ğ˜ Ğ§Ğ°Ñ‚-ĞÑÑĞ¸ÑÑ‚ĞµĞ½Ñ‚',
          subtitle: 'ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° 24/7 Ğ² Ğ»ÑĞ±Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ',
          quickActions: 'Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ',
          emergency: 'Ğ­ĞºÑÑ‚Ñ€ĞµĞ½Ğ½Ñ‹Ğµ ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹',
          translation: 'ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´',
          nearby: 'Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ ĞŸĞ¾Ğ±Ğ»Ğ¸Ğ·Ğ¾ÑÑ‚Ğ¸',
          weather: 'Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ĞŸĞ¾Ğ³Ğ¾Ğ´Ğµ',
          helpCenter: 'Ğ¦ĞµĞ½Ñ‚Ñ€ ĞŸĞ¾Ğ¼Ğ¾Ñ‰Ğ¸',
          inputPlaceholder: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ...',
          emergencyContent: `ğŸš¨ Ğ­ĞºÑÑ‚Ñ€ĞµĞ½Ğ½Ñ‹Ğµ ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹

ĞŸĞ¾Ğ»Ğ¸Ñ†Ğ¸Ñ: 110
ĞŸĞ¾Ğ¶Ğ°Ñ€Ğ½Ğ°Ñ/Ğ¡ĞºĞ¾Ñ€Ğ°Ñ: 119
Ğ¢ÑƒÑ€Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ›Ğ¸Ğ½Ğ¸Ñ: 050-3816-2787

ĞŸÑ€Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¸ Ğ¾ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ğµ Ğ¾Ñ€Ğ¸ĞµĞ½Ñ‚Ğ¸Ñ€Ñ‹ Ğ¸Ğ»Ğ¸ Ğ°Ğ´Ñ€ĞµÑĞ°.`,
          translationContent: 'Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ°. Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´ Ñ‚ĞµĞºÑÑ‚Ğ°, Ğ³Ğ¾Ğ»Ğ¾ÑĞ° Ğ¸ Ñ„Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ğ¹.',
          nearbyContent: 'Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¸ÑĞºĞ°Ñ‚ÑŒ Ñ‚ÑƒÑ€Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´Ğ¾ÑÑ‚Ğ¾Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸, Ñ€ĞµÑÑ‚Ğ¾Ñ€Ğ°Ğ½Ñ‹ Ğ¸ Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚ Ğ²Ğ¾ĞºÑ€ÑƒĞ³ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ.',
          weatherContent: `ğŸŒ¤ï¸ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ĞŸĞ¾Ğ³Ğ¾Ğ´Ğµ Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ

Ğ¢Ğ¾ĞºĞ¸Ğ¾: Ğ¡Ğ¾Ğ»Ğ½ĞµÑ‡Ğ½Ğ¾, 22Â°C
ĞÑĞ°ĞºĞ°: ĞĞ±Ğ»Ğ°Ñ‡Ğ½Ğ¾, 20Â°C
ĞšĞ¸Ğ¾Ñ‚Ğ¾: Ğ¡Ğ¾Ğ»Ğ½ĞµÑ‡Ğ½Ğ¾, 21Â°C

â€»ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ÑĞ°Ğ¹Ñ‚ Ğ¯Ğ¿Ğ¾Ğ½ÑĞºĞ¾Ğ³Ğ¾ ĞœĞµÑ‚ĞµĞ¾Ñ€Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ ĞĞ³ĞµĞ½Ñ‚ÑÑ‚Ğ²Ğ° Ğ´Ğ»Ñ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸.`,
          greeting: 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! Ğ¡Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ Ñ‡Ñ‚Ğ¾ ÑƒĞ³Ğ¾Ğ´Ğ½Ğ¾ Ğ¾ Ğ¿ÑƒÑ‚ĞµÑˆĞµÑÑ‚Ğ²Ğ¸ÑÑ… Ğ² Ğ¯Ğ¿Ğ¾Ğ½Ğ¸Ñ.'
        };
      case 'ar':
        return {
          title: 'Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
          subtitle: 'Ø¯Ø¹Ù… 24/7 ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª',
          quickActions: 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©',
          emergency: 'Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø·Ø§Ø±Ø¦Ø©',
          translation: 'Ø§Ù„ØªØ±Ø¬Ù…Ø©',
          nearby: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù‚Ø±ÙŠØ¨Ø©',
          weather: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù‚Ø³',
          helpCenter: 'Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©',
          inputPlaceholder: 'Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...',
          emergencyContent: `ğŸš¨ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø·Ø§Ø±Ø¦Ø©

Ø§Ù„Ø´Ø±Ø·Ø©: 110
Ø§Ù„Ø¥Ø·ÙØ§Ø¡/Ø§Ù„Ø¥Ø³Ø¹Ø§Ù: 119
Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù† Ø§Ù„Ø³ÙŠØ§Ø­ÙŠ: 050-3816-2787

Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ù…ÙˆÙ‚Ø¹ÙƒØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ù… Ø£Ùˆ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù‚Ø±ÙŠØ¨Ø©.`,
          translationContent: 'Ù…ÙŠØ²Ø§Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…ØªØ§Ø­Ø©. ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ ÙˆØ§Ù„ØµÙˆØª ÙˆØ§Ù„ØµÙˆØ± Ù…Ù…ÙƒÙ†Ø©.',
          nearbyContent: 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ù… Ø§Ù„Ø³ÙŠØ§Ø­ÙŠØ© ÙˆØ§Ù„Ù…Ø·Ø§Ø¹Ù… ÙˆØ§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª Ø­ÙˆÙ„ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ.',
          weatherContent: `ğŸŒ¤ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„ÙŠÙˆÙ…

Ø·ÙˆÙƒÙŠÙˆ: Ù…Ø´Ù…Ø³ØŒ 22Â°C
Ø£ÙˆØ³Ø§ÙƒØ§: ØºØ§Ø¦Ù…ØŒ 20Â°C
ÙƒÙŠÙˆØªÙˆ: Ù…Ø´Ù…Ø³ØŒ 21Â°C

â€»ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…ÙˆÙ‚Ø¹ ÙˆÙƒØ§Ù„Ø© Ø§Ù„Ø£Ø±ØµØ§Ø¯ Ø§Ù„Ø¬ÙˆÙŠØ© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø­Ø¯Ø« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù‚Ø³.`,
          greeting: 'Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡ Ø¹Ù† Ø§Ù„Ø³ÙØ± Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ§Ø¨Ø§Ù†.'
        };
      case 'id':
        return {
          title: 'Asisten Chat AI',
          subtitle: 'Dukungan 24/7 kapan saja',
          quickActions: 'Tindakan Cepat',
          emergency: 'Kontak Darurat',
          translation: 'Terjemahan',
          nearby: 'Info Sekitar',
          weather: 'Info Cuaca',
          helpCenter: 'Pusat Bantuan',
          inputPlaceholder: 'Ketik pesan...',
          emergencyContent: `ğŸš¨ Kontak Darurat

Polisi: 110
Pemadam Kebakaran/Ambulans: 119
Hotline Wisata: 050-3816-2787

Saat melaporkan lokasi Anda, periksa landmark atau alamat terdekat.`,
          translationContent: 'Fitur terjemahan tersedia. Terjemahan teks, suara, dan foto dimungkinkan.',
          nearbyContent: 'Anda dapat mencari tempat wisata, restoran, dan transportasi di sekitar lokasi Anda.',
          weatherContent: `ğŸŒ¤ï¸ Informasi Cuaca Hari Ini

Tokyo: Cerah, 22Â°C
Osaka: Berawan, 20Â°C
Kyoto: Cerah, 21Â°C

â€»Silakan periksa situs web Badan Meteorologi Jepang untuk informasi cuaca terbaru.`,
          greeting: 'Halo! Tanyakan apa saja tentang perjalanan ke Jepang.'
        };
      case 'pt':
        return {
          title: 'Assistente de Chat IA',
          subtitle: 'Suporte 24/7 a qualquer momento',
          quickActions: 'AÃ§Ãµes RÃ¡pidas',
          emergency: 'Contatos de EmergÃªncia',
          translation: 'TraduÃ§Ã£o',
          nearby: 'InformaÃ§Ãµes PrÃ³ximas',
          weather: 'InformaÃ§Ãµes do Tempo',
          helpCenter: 'Central de Ajuda',
          inputPlaceholder: 'Digite uma mensagem...',
          emergencyContent: `ğŸš¨ Contatos de EmergÃªncia

PolÃ­cia: 110
Bombeiros/AmbulÃ¢ncia: 119
Linha TurÃ­stica: 050-3816-2787

Ao relatar sua localizaÃ§Ã£o, verifique pontos de referÃªncia ou endereÃ§os prÃ³ximos.`,
          translationContent: 'Recursos de traduÃ§Ã£o estÃ£o disponÃ­veis. TraduÃ§Ã£o de texto, voz e foto sÃ£o possÃ­veis.',
          nearbyContent: 'VocÃª pode pesquisar atraÃ§Ãµes turÃ­sticas, restaurantes e transporte ao redor da sua localizaÃ§Ã£o.',
          weatherContent: `ğŸŒ¤ï¸ InformaÃ§Ãµes do Tempo Hoje

TÃ³quio: Ensolarado, 22Â°C
Osaka: Nublado, 20Â°C
Quioto: Ensolarado, 21Â°C

â€»Consulte o site da AgÃªncia MeteorolÃ³gica do JapÃ£o para informaÃ§Ãµes atualizadas.`,
          greeting: 'OlÃ¡! Pergunte-me qualquer coisa sobre viajar para o JapÃ£o.'
        };
      case 'th':
        return {
          title: 'à¸œà¸¹à¹‰à¸Šà¹ˆà¸§à¸¢à¹à¸Šà¸— AI',
          subtitle: 'à¸ªà¸™à¸±à¸šà¸ªà¸™à¸¸à¸™ 24/7 à¸•à¸¥à¸­à¸”à¹€à¸§à¸¥à¸²',
          quickActions: 'à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¸”à¹ˆà¸§à¸™',
          emergency: 'à¸•à¸´à¸”à¸•à¹ˆà¸­à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™',
          translation: 'à¸à¸²à¸£à¹à¸›à¸¥',
          nearby: 'à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸à¸¥à¹‰à¹€à¸„à¸µà¸¢à¸‡',
          weather: 'à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸ à¸²à¸à¸­à¸²à¸à¸²à¸¨',
          helpCenter: 'à¸¨à¸¹à¸™à¸¢à¹Œà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­',
          inputPlaceholder: 'à¸à¸´à¸¡à¸à¹Œà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡...',
          emergencyContent: `ğŸš¨ à¸•à¸´à¸”à¸•à¹ˆà¸­à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™

à¸•à¸³à¸£à¸§à¸ˆ: 110
à¸”à¸±à¸šà¹€à¸à¸¥à¸´à¸‡/à¸£à¸–à¸à¸¢à¸²à¸šà¸²à¸¥: 119
à¸ªà¸²à¸¢à¸”à¹ˆà¸§à¸™à¸—à¹ˆà¸­à¸‡à¹€à¸—à¸µà¹ˆà¸¢à¸§: 050-3816-2787

à¹€à¸¡à¸·à¹ˆà¸­à¸£à¸²à¸¢à¸‡à¸²à¸™à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“ à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸ªà¸³à¸„à¸±à¸à¸«à¸£à¸·à¸­à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¹ƒà¸à¸¥à¹‰à¹€à¸„à¸µà¸¢à¸‡`,
          translationContent: 'à¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œà¸à¸²à¸£à¹à¸›à¸¥à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ à¸ªà¸²à¸¡à¸²à¸£à¸–à¹à¸›à¸¥à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ à¹€à¸ªà¸µà¸¢à¸‡ à¹à¸¥à¸°à¸£à¸¹à¸›à¸ à¸²à¸à¹„à¸”à¹‰',
          nearbyContent: 'à¸„à¸¸à¸“à¸ªà¸²à¸¡à¸²à¸£à¸–à¸„à¹‰à¸™à¸«à¸²à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸—à¹ˆà¸­à¸‡à¹€à¸—à¸µà¹ˆà¸¢à¸§ à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£ à¹à¸¥à¸°à¸à¸²à¸£à¸‚à¸™à¸ªà¹ˆà¸‡à¸£à¸­à¸šà¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¸‚à¸­à¸‡à¸„à¸¸à¸“',
          weatherContent: `ğŸŒ¤ï¸ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸ à¸²à¸à¸­à¸²à¸à¸²à¸¨à¸§à¸±à¸™à¸™à¸µà¹‰

à¹‚à¸•à¹€à¸à¸µà¸¢à¸§: à¹à¸ˆà¹ˆà¸¡à¹ƒà¸ª 22Â°C
à¹‚à¸­à¸‹à¸²à¸à¹‰à¸²: à¸¡à¸µà¹€à¸¡à¸† 20Â°C
à¹€à¸à¸µà¸¢à¸§à¹‚à¸•: à¹à¸ˆà¹ˆà¸¡à¹ƒà¸ª 21Â°C

â€»à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸§à¹‡à¸šà¹„à¸‹à¸•à¹Œà¸à¸£à¸¡à¸­à¸¸à¸•à¸¸à¸™à¸´à¸¢à¸¡à¸§à¸´à¸—à¸¢à¸²à¸à¸µà¹ˆà¸›à¸¸à¹ˆà¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸ à¸²à¸à¸­à¸²à¸à¸²à¸¨à¸¥à¹ˆà¸²à¸ªà¸¸à¸”`,
          greeting: 'à¸ªà¸§à¸±à¸ªà¸”à¸µ! à¸–à¸²à¸¡à¸­à¸°à¹„à¸£à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¸à¸²à¸£à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¹ƒà¸™à¸à¸µà¹ˆà¸›à¸¸à¹ˆà¸™à¹„à¸”à¹‰à¹€à¸¥à¸¢'
        };
      case 'vi':
        return {
          title: 'Trá»£ LÃ½ Chat AI',
          subtitle: 'Há»— trá»£ 24/7 báº¥t cá»© lÃºc nÃ o',
          quickActions: 'HÃ nh Äá»™ng Nhanh',
          emergency: 'LiÃªn Há»‡ Kháº©n Cáº¥p',
          translation: 'Dá»‹ch Thuáº­t',
          nearby: 'ThÃ´ng Tin Gáº§n ÄÃ¢y',
          weather: 'ThÃ´ng Tin Thá»i Tiáº¿t',
          helpCenter: 'Trung TÃ¢m Trá»£ GiÃºp',
          inputPlaceholder: 'Nháº­p tin nháº¯n...',
          emergencyContent: `ğŸš¨ LiÃªn Há»‡ Kháº©n Cáº¥p

Cáº£nh sÃ¡t: 110
Cá»©u há»a/Cáº¥p cá»©u: 119
ÄÆ°á»ng dÃ¢y nÃ³ng du lá»‹ch: 050-3816-2787

Khi bÃ¡o cÃ¡o vá»‹ trÃ­ cá»§a báº¡n, hÃ£y kiá»ƒm tra cÃ¡c Ä‘á»‹a danh hoáº·c Ä‘á»‹a chá»‰ gáº§n Ä‘Ã³.`,
          translationContent: 'CÃ¡c tÃ­nh nÄƒng dá»‹ch thuáº­t cÃ³ sáºµn. CÃ³ thá»ƒ dá»‹ch vÄƒn báº£n, giá»ng nÃ³i vÃ  áº£nh.',
          nearbyContent: 'Báº¡n cÃ³ thá»ƒ tÃ¬m kiáº¿m cÃ¡c Ä‘iá»ƒm tham quan, nhÃ  hÃ ng vÃ  phÆ°Æ¡ng tiá»‡n giao thÃ´ng xung quanh vá»‹ trÃ­ hiá»‡n táº¡i.',
          weatherContent: `ğŸŒ¤ï¸ ThÃ´ng Tin Thá»i Tiáº¿t HÃ´m Nay

Tokyo: Náº¯ng, 22Â°C
Osaka: CÃ³ mÃ¢y, 20Â°C
Kyoto: Náº¯ng, 21Â°C

â€»Vui lÃ²ng kiá»ƒm tra trang web CÆ¡ quan KhÃ­ tÆ°á»£ng Nháº­t Báº£n Ä‘á»ƒ biáº¿t thÃ´ng tin thá»i tiáº¿t má»›i nháº¥t.`,
          greeting: 'Xin chÃ o! Há»i tÃ´i báº¥t cá»© Ä‘iá»u gÃ¬ vá» du lá»‹ch Nháº­t Báº£n.'
        };
      case 'it':
        return {
          title: 'Assistente Chat IA',
          subtitle: 'Supporto 24/7 in qualsiasi momento',
          quickActions: 'Azioni Rapide',
          emergency: 'Contatti di Emergenza',
          translation: 'Traduzione',
          nearby: 'Informazioni Vicine',
          weather: 'Informazioni Meteo',
          helpCenter: 'Centro Assistenza',
          inputPlaceholder: 'Scrivi un messaggio...',
          emergencyContent: `ğŸš¨ Contatti di Emergenza

Polizia: 110
Vigili del Fuoco/Ambulanza: 119
Linea Turistica: 050-3816-2787

Quando riporti la tua posizione, controlla punti di riferimento o indirizzi vicini.`,
          translationContent: 'Le funzioni di traduzione sono disponibili. Ãˆ possibile tradurre testo, voce e foto.',
          nearbyContent: 'Puoi cercare attrazioni turistiche, ristoranti e trasporti intorno alla tua posizione attuale.',
          weatherContent: `ğŸŒ¤ï¸ Informazioni Meteo di Oggi

Tokyo: Soleggiato, 22Â°C
Osaka: Nuvoloso, 20Â°C
Kyoto: Soleggiato, 21Â°C

â€»Controlla il sito dell'Agenzia Meteorologica del Giappone per informazioni aggiornate.`,
          greeting: 'Ciao! Chiedimi qualsiasi cosa sui viaggi in Giappone.'
        };
      default: // Japanese
        return {
          title: 'AIãƒãƒ£ãƒƒãƒˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ',
          subtitle: '24æ™‚é–“ã„ã¤ã§ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¾ã™',
          quickActions: 'ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³',
          emergency: 'ç·Šæ€¥é€£çµ¡å…ˆ',
          translation: 'ç¿»è¨³',
          nearby: 'å‘¨è¾ºæƒ…å ±',
          weather: 'å¤©æ°—æƒ…å ±',
          helpCenter: 'ãƒ˜ãƒ«ãƒ—ã‚»ãƒ³ã‚¿ãƒ¼',
          inputPlaceholder: 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...',
          emergencyContent: `ğŸš¨ ç·Šæ€¥é€£çµ¡å…ˆ

è­¦å¯Ÿ: 110
æ¶ˆé˜²ãƒ»æ•‘æ€¥: 119
è¦³å…‰ãƒ›ãƒƒãƒˆãƒ©ã‚¤ãƒ³: 050-3816-2787

ç¾åœ¨åœ°ã‚’ä¼ãˆã‚‹éš›ã¯ã€è¿‘ãã®ç›®å°ã‚„ä½æ‰€ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`,
          translationContent: 'ç¿»è¨³æ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆç¿»è¨³ã€éŸ³å£°ç¿»è¨³ã€å†™çœŸç¿»è¨³ãŒå¯èƒ½ã§ã™ã€‚',
          nearbyContent: 'ç¾åœ¨åœ°å‘¨è¾ºã®è¦³å…‰ã‚¹ãƒãƒƒãƒˆã€ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã€äº¤é€šæ©Ÿé–¢ã‚’æ¤œç´¢ã§ãã¾ã™ã€‚',
          weatherContent: `ğŸŒ¤ï¸ ä»Šæ—¥ã®å¤©æ°—æƒ…å ±

æ±äº¬: æ™´ã‚Œã€æ°—æ¸© 22Â°C
å¤§é˜ª: æ›‡ã‚Šã€æ°—æ¸© 20Â°C
äº¬éƒ½: æ™´ã‚Œã€æ°—æ¸© 21Â°C

â€»æœ€æ–°ã®å¤©æ°—æƒ…å ±ã¯æ°—è±¡åºã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§ã”ç¢ºèªãã ã•ã„ã€‚`,
          greeting: 'ã“ã‚“ã«ã¡ã¯ï¼æ—¥æœ¬æ—…è¡Œã«ã¤ã„ã¦ä½•ã§ã‚‚ãŠèããã ã•ã„ã€‚'
        };
    }
  };

const content = getLocalizedContent();

const prevLangRef = useRef<string | null>(null);

useEffect(() => {
  if (prevLangRef.current !== currentLanguage) {
    setMessages([]);

    let cancelled = false;
    const tid = window.setTimeout(() => {
      if (cancelled) return;
      addBotMessage(content.greeting);
      // â˜… å®Ÿéš›ã«æŒ¨æ‹¶ã‚’å‡ºã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æ›´æ–°
      prevLangRef.current = currentLanguage;
    }, 100);

    return () => {
      cancelled = true;  // â˜… StrictModeã®1å›ç›®ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      clearTimeout(tid);
    };
  }
}, [currentLanguage, content.greeting]);


  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  const addBotMessage = (content: string, actions?: Array<{ label: string; action: () => void }>) => {
    const message: Message = {
      id: `bot_${Date.now()}`,
      type: 'bot',
      content,
      timestamp: new Date().toISOString(),
      actions
    };
    setMessages(prev => [...prev, message]);
  };

  const addUserMessage = (content: string) => {
    const message: Message = {
      id: `user_${Date.now()}`,
      type: 'user',
      content,
      timestamp: new Date().toISOString()
    };
    setMessages(prev => [...prev, message]);
  };

  const handleSendMessage = async () => {
    if (!inputMessage.trim()) return;

    const userMessage = inputMessage;
    setInputMessage('');
    addUserMessage(userMessage);
    setIsTyping(true);

    // Reset error state
    setIsError(false);

    try {
      const result = await apiCall('/openai-chat', {
        method: 'POST',
        body: JSON.stringify({
          message: userMessage,
          language: currentLanguage || 'ja',
          context: 'travel_japan'
        })
      });

      console.log('[ChatBot] OpenAI API response:', result);
      
      if (result.success && result.response && typeof result.response === 'string' && result.response.trim()) {
        // Check if this is mock data
        if (result.isMockData) {
          setShowMockNotice(true);
        }
        
        addBotMessage(result.response, [
          {
            label: t('chat.mapCheck'),
           action: () => { window.open('/map', '_blank'); }
          },
          {
            label: t('chat.moreInfo'),
            action: () => console.log('Show details')
          }
        ]);
      } else {
        console.warn('[ChatBot] Invalid response format:', result);
        throw new Error(result.message || 'AIå¿œç­”ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (error) {
      const apiError = error as APIError;
      
      // Log error with context
      globalErrorHandler.handleError(apiError, {
        page: 'ChatBot',
        action: 'sendMessage',
        userAgent: navigator.userAgent,
        url: window.location.href
      });
      
      // Handle specific AWS errors
      const errorInfo = handleAWSError(apiError);
      
      console.error('ChatBot API Error:', {
        message: apiError.message,
        status: apiError.status,
        code: apiError.code,
        endpoint: apiError.endpoint,
        userMessage: userMessage,
        language: currentLanguage
      });
      
      setIsError(true);
      
      // Show user-friendly error message
      if (apiError.code === 'NETWORK_OFFLINE') {
        addBotMessage('ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒã‚ã‚Šã¾ã›ã‚“ã€‚æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
      } else if (apiError.code === 'TIMEOUT') {
        addBotMessage('å¿œç­”ã«æ™‚é–“ãŒã‹ã‹ã£ã¦ã„ã¾ã™ã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
      } else if (apiError.status === 429) {
        addBotMessage('ã‚¢ã‚¯ã‚»ã‚¹ãŒé›†ä¸­ã—ã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰ãŠè©¦ã—ãã ã•ã„ã€‚');
      } else if (apiError.status && apiError.status >= 500) {
        addBotMessage('ã‚µãƒ¼ãƒãƒ¼ã§å•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰ãŠè©¦ã—ãã ã•ã„ã€‚');
      } else {
        addBotMessage(errorInfo.message || 'AIã‚µãƒ¼ãƒ“ã‚¹ãŒä¸€æ™‚çš„ã«åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰ãŠè©¦ã—ãã ã•ã„ã€‚');
      }
      
      // Add retry action for retryable errors
      if (apiError.retryable) {
        addBotMessage('', [
          {
            label: 'ã‚‚ã†ä¸€åº¦è©¦ã™',
            action: () => {
              setInputMessage(userMessage);
              handleSendMessage();
            }
          }
        ]);
      }
    } finally {
      setIsTyping(false);
    }
  };

  const handleQuickAction = (action: string) => {
    switch (action) {
      case 'emergency':
        addBotMessage(content.emergencyContent);
        break;
      case 'translation':
        addBotMessage(content.translationContent, [
          {
            label: currentLanguage === 'en' ? 'Open Translation Tool' :
                   currentLanguage === 'zh' ? 'æ‰“å¼€ç¿»è¯‘å·¥å…·' :
                   currentLanguage === 'ko' ? 'ë²ˆì—­ ë„êµ¬ ì—´ê¸°' :
                   currentLanguage === 'es' ? 'Abrir Herramienta de TraducciÃ³n' :
                   currentLanguage === 'fr' ? 'Ouvrir l\'Outil de Traduction' :
                   currentLanguage === 'hi' ? 'à¤…à¤¨à¥à¤µà¤¾à¤¦ à¤‰à¤ªà¤•à¤°à¤£ à¤–à¥‹à¤²à¥‡à¤‚' :
                   currentLanguage === 'ru' ? 'ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ°' :
                   currentLanguage === 'ar' ? 'ÙØªØ­ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø©' :
                   currentLanguage === 'id' ? 'Buka Alat Terjemahan' :
                   currentLanguage === 'pt' ? 'Abrir Ferramenta de TraduÃ§Ã£o' :
                   currentLanguage === 'th' ? 'à¹€à¸›à¸´à¸”à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¹à¸›à¸¥' :
                   currentLanguage === 'vi' ? 'Má»Ÿ CÃ´ng Cá»¥ Dá»‹ch' :
                   currentLanguage === 'it' ? 'Apri Strumento di Traduzione' :
                   'ç¿»è¨³ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã',
            action: () => window.open('/translate', '_blank')
          }
        ]);
        break;
      case 'nearby':
        addBotMessage(content.nearbyContent, [
          {
            label: currentLanguage === 'en' ? 'Open Map' :
                   currentLanguage === 'zh' ? 'æ‰“å¼€åœ°å›¾' :
                   currentLanguage === 'ko' ? 'ì§€ë„ ì—´ê¸°' :
                   currentLanguage === 'es' ? 'Abrir Mapa' :
                   currentLanguage === 'fr' ? 'Ouvrir la Carte' :
                   currentLanguage === 'hi' ? 'à¤®à¥ˆà¤ª à¤–à¥‹à¤²à¥‡à¤‚' :
                   currentLanguage === 'ru' ? 'ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ ĞšĞ°Ñ€Ñ‚Ñƒ' :
                   currentLanguage === 'ar' ? 'ÙØªØ­ Ø§Ù„Ø®Ø±ÙŠØ·Ø©' :
                   currentLanguage === 'id' ? 'Buka Peta' :
                   currentLanguage === 'pt' ? 'Abrir Mapa' :
                   currentLanguage === 'th' ? 'à¹€à¸›à¸´à¸”à¹à¸œà¸™à¸—à¸µà¹ˆ' :
                   currentLanguage === 'vi' ? 'Má»Ÿ Báº£n Äá»“' :
                   currentLanguage === 'it' ? 'Apri Mappa' :
                   'åœ°å›³ã‚’é–‹ã',
            action: () => window.open('/map', '_blank')
          }
        ]);
        break;
      case 'weather':
        addBotMessage(content.weatherContent);
        break;
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 pt-20">
      <div className="max-w-4xl mx-auto px-6 py-8">
        {/* Header */}
        <motion.div
          className="text-center mb-8"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8 }}
        >
          <h1 className="text-4xl font-bold text-gray-800 mb-4">{content.title}</h1>
          <p className="text-lg text-gray-600">{content.subtitle}</p>
        </motion.div>

        <div className="grid lg:grid-cols-4 gap-8">
          {/* Quick Actions */}
          <div className="lg:col-span-1 space-y-4">
            <h3 className="text-lg font-bold text-gray-800">{content.quickActions}</h3>
            
            <div className="space-y-3">
              <button
                onClick={() => handleQuickAction('emergency')}
                className="w-full flex items-center space-x-3 p-3 bg-red-100 text-red-700 rounded-xl hover:bg-red-200 transition-colors"
              >
                <Phone className="w-5 h-5" />
                <span>{content.emergency}</span>
              </button>
              
              <button
                onClick={() => handleQuickAction('translation')}
                className="w-full flex items-center space-x-3 p-3 bg-blue-100 text-blue-700 rounded-xl hover:bg-blue-200 transition-colors"
              >
                <Translate className="w-5 h-5" />
                <span>{content.translation}</span>
              </button>
              
              <button
                onClick={() => handleQuickAction('nearby')}
                className="w-full flex items-center space-x-3 p-3 bg-green-100 text-green-700 rounded-xl hover:bg-green-200 transition-colors"
              >
                <MapPin className="w-5 h-5" />
                <span>{content.nearby}</span>
              </button>
              
              <button
                onClick={() => handleQuickAction('weather')}
                className="w-full flex items-center space-x-3 p-3 bg-yellow-100 text-yellow-700 rounded-xl hover:bg-yellow-200 transition-colors"
              >
                <Camera className="w-5 h-5" />
                <span>{content.weather}</span>
              </button>
              
              <button
                onClick={() => window.open('/help', '_blank')}
                className="w-full flex items-center space-x-3 p-3 bg-purple-100 text-purple-700 rounded-xl hover:bg-purple-200 transition-colors"
              >
                <Book className="w-5 h-5" />
                <span>{content.helpCenter}</span>
              </button>
            </div>
          </div>

          {/* Chat Interface */}
          <div className="lg:col-span-3">
            <motion.div
              className="bg-white rounded-3xl shadow-lg overflow-hidden"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.5, delay: 0.2 }}
            >
              {/* Messages */}
              <div className="h-96 overflow-y-auto p-6 space-y-4">
                <AnimatePresence>
                  {messages.map((message) => (
                    <motion.div
                      key={message.id}
                      className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`}
                      initial={{ opacity: 0, y: 20 }}
                      animate={{ opacity: 1, y: 0 }}
                      exit={{ opacity: 0, y: -20 }}
                      transition={{ duration: 0.3 }}
                    >
                      <div className={`flex items-start space-x-3 max-w-xs lg:max-w-md ${message.type === 'user' ? 'flex-row-reverse space-x-reverse' : ''}`}>
                        <div className={`w-8 h-8 rounded-full flex items-center justify-center ${message.type === 'user' ? 'bg-purple-500' : 'bg-blue-500'}`}>
                          {message.type === 'user' ? (
                            <User className="w-4 h-4 text-white" />
                          ) : (
                            <Bot className="w-4 h-4 text-white" />
                          )}
                        </div>
                        
                        <div className={`p-3 rounded-2xl ${message.type === 'user' ? 'bg-purple-500 text-white' : 'bg-gray-100 text-gray-800'}`}>
                          <p className="whitespace-pre-wrap">{message.content}</p>
                          
                          {message.actions && (
                            <div className="mt-3 space-y-2">
                              {message.actions.map((action, index) => (
                                <button
                                  key={index}
                                  onClick={action.action}
                                  className="block w-full text-left px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-sm transition-colors"
                                >
                                  {action.label}
                                </button>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>
                    </motion.div>
                  ))}
                </AnimatePresence>

                {isTyping && (
                  <motion.div
                    className="flex justify-start"
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                  >
                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                        <Bot className="w-4 h-4 text-white" />
                      </div>
                      <div className="bg-gray-100 p-4 rounded-2xl">
                        <div className="flex space-x-1">
                          <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                          <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0.1s' }}></div>
                          <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
                        </div>
                      </div>
                    </div>
                  </motion.div>
                )}
                
                {isError && (
                  <motion.div
                    className="flex justify-start"
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                  >
                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center">
                        <Bot className="w-4 h-4 text-white" />
                      </div>
                      <div className="bg-red-100 p-3 rounded-2xl">
                        <p className="text-red-700">ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚ä¸€æ™‚çš„ã«ã‚µãƒ¼ãƒ“ã‚¹ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚</p>
                      </div>
                    </div>
                  </motion.div>
                )}

                <div ref={messagesEndRef} />
              </div>

              {/* Input */}
              <div className="border-t border-gray-200 p-4">
                <div className="flex space-x-3">
                  <input
                    type="text"
                    value={inputMessage}
                    onChange={(e) => setInputMessage(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}
                    placeholder={content.inputPlaceholder}
                    className="flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                  />
                  {isTyping ? (
                    <div className="px-6 py-3 bg-gray-400 text-white rounded-xl">
                      <Loader className="w-5 h-5 animate-spin" />
                    </div>
                  ) : (
                    <button
                      onClick={handleSendMessage}
                      disabled={!inputMessage.trim() || isTyping}
                      className="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      <Send className="w-5 h-5" />
                    </button>
                  )}
                </div>
              </div>
            </motion.div>
            
            {/* Mock Data Notice */}
            {showMockNotice && (
              <MockDataNotice 
                onRetry={() => setShowMockNotice(false)}
                className="max-w-4xl mx-auto mb-4"
              />
            )}
          </div>
        </div>
      </div>
    </div>
  );
};

export default ChatBot;
</file>

<file path="src/pages/TripDetail.tsx">
import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useParams, useNavigate } from 'react-router-dom';
import { ArrowLeft, MapPin, Calendar, Clock, Star, Edit, Share, Download, Info, Users, ExternalLink, Globe, Languages, X, Loader, Sparkles, Lock, Eye } from 'lucide-react';
import { useTrip } from '../contexts/TripContext';
import { useLanguage } from '../contexts/LanguageContext';
import { useAuth } from '../contexts/AuthContext';
import { apiCall, API_CONFIG, buildApiUrl, APIError } from '../config/api';
import { handleAWSError, autoRecovery, globalErrorHandler } from '../utils/errorHandler';
import MockDataNotice from '../components/MockDataNotice';

const TripDetail: React.FC = () => {
  const { tripId } = useParams();
  const navigate = useNavigate();
  const { trips } = useTrip();
  const { t } = useLanguage();
  const { isPremium } = useAuth();
  const [trip, setTrip] = useState<any>(null);
  const [selectedActivity, setSelectedActivity] = useState<any>(null);
  const [activityDetails, setActivityDetails] = useState<any>(null);
  const [isLoadingDetails, setIsLoadingDetails] = useState(false);
  const [showTranslator, setShowTranslator] = useState(false);
  const [translatedText, setTranslatedText] = useState('');
  const [isTranslating, setIsTranslating] = useState(false);
  const [targetLanguage, setTargetLanguage] = useState('en');
  const [textToTranslate, setTextToTranslate] = useState('');
  const [showMockNotice, setShowMockNotice] = useState(false);

  // Mock trip data
  useEffect(() => {
    const foundTrip = trips.find(t => t.id === tripId);
    if (foundTrip) {
      setTrip(foundTrip);
    } else {
      // Fallback to mock data if not found in context
      const mockTrip = {
        id: tripId,
        title: 'æ˜¥ã®æ¡œæ—…',
        destination: 'æ±äº¬ãƒ»äº¬éƒ½',
        startDate: '2024-04-01',
        endDate: '2024-04-05',
        status: 'upcoming',
        image: 'https://images.pexels.com/photos/2070033/pexels-photo-2070033.jpeg',
        itinerary: [
          {
            day: 1,
            date: '2024-04-01',
            title: 'æ±äº¬åˆ°ç€ãƒ»æµ…è‰æ¢ç´¢',
            activities: [
              { time: '10:00', name: 'ç¾½ç”°ç©ºæ¸¯åˆ°ç€', location: 'ç¾½ç”°ç©ºæ¸¯', type: 'transport' },
              { 
                time: '12:00', 
                name: 'æµ…è‰å¯ºå‚æ‹', 
                location: 'æµ…è‰', 
                type: 'culture', 
                rating: 4.8,
                duration: '90',
                description: 'æ±äº¬æœ€å¤ã®å¯ºé™¢ã§æ­´å²ã¨æ–‡åŒ–ã‚’æ„Ÿã˜ã‚‹',
                estimatedCost: '0 JPY',
                tips: 'æ—©æœã®å‚æ‹ãŒãŠã™ã™ã‚ã§ã™ã€‚æ··é›‘ã‚’é¿ã‘ã‚‰ã‚Œã¾ã™ã€‚'
              },
              { 
                time: '14:00', 
                name: 'ä»²è¦‹ä¸–é€šã‚Šæ•£ç­–', 
                location: 'æµ…è‰', 
                type: 'shopping', 
                rating: 4.6,
                duration: '120',
                description: 'ä¼çµ±çš„ãªãŠåœŸç”£ã‚„å’Œè“å­ã‚’æ¥½ã—ã‚ã‚‹å•†åº—è¡—',
                estimatedCost: '3000 JPY',
                tips: 'äººå½¢ç„¼ãã¨é›·ãŠã“ã—ãŒåç‰©ã§ã™ã€‚'
              },
              { 
                time: '18:00', 
                name: 'å¤©ã·ã‚‰å¤•é£Ÿ', 
                location: 'æµ…è‰', 
                type: 'food', 
                rating: 4.7,
                duration: '90',
                description: 'è€èˆ—å¤©ã·ã‚‰åº—ã§æœ¬æ ¼çš„ãªæ±Ÿæˆ¸å‰å¤©ã·ã‚‰ã‚’å ªèƒ½',
                estimatedCost: '4500 JPY',
                tips: 'äºˆç´„æ¨å¥¨ã€‚ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å¸­ãŒãŠã™ã™ã‚ã§ã™ã€‚'
              }
            ]
          },
          {
            day: 2,
            date: '2024-04-02',
            title: 'æ¸‹è°·ãƒ»åŸå®¿ã‚«ãƒ«ãƒãƒ£ãƒ¼ä½“é¨“',
            activities: [
              { 
                time: '09:00', 
                name: 'æ˜æ²»ç¥å®®å‚æ‹', 
                location: 'åŸå®¿', 
                type: 'culture', 
                rating: 4.9,
                duration: '90',
                description: 'æ±äº¬ã®å¿ƒéœŠçš„ãªä¸­å¿ƒåœ°ã§é™å¯‚ãªã²ã¨ã¨ãã‚’',
                estimatedCost: '0 JPY',
                tips: 'æ—©æœã®å‚æ‹ãŒç‰¹ã«ãŠã™ã™ã‚ã§ã™ã€‚'
              },
              { 
                time: '11:00', 
                name: 'ç«¹ä¸‹é€šã‚Šæ•£ç­–', 
                location: 'åŸå®¿', 
                type: 'shopping', 
                rating: 4.5,
                duration: '60',
                description: 'è‹¥è€…æ–‡åŒ–ã®ç™ºä¿¡åœ°ã§ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½“é¨“',
                estimatedCost: '5000 JPY',
                tips: 'å¹³æ—¥ã®æ–¹ãŒæ··é›‘ãŒå°‘ãªã„ã§ã™ã€‚'
              },
              { 
                time: '14:00', 
                name: 'æ¸‹è°·ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹', 
                location: 'æ¸‹è°·', 
                type: 'sightseeing', 
                rating: 4.8,
                duration: '30',
                description: 'ä¸–ç•Œã§æœ€ã‚‚æœ‰åãªäº¤å·®ç‚¹ã‚’ä½“é¨“',
                estimatedCost: '0 JPY',
                tips: 'ã‚¹ã‚¿ãƒ¼ãƒãƒƒã‚¯ã‚¹2éšã‹ã‚‰ã®çœºã‚ãŒæœ€é«˜ã§ã™ã€‚'
              },
              { 
                time: '16:00', 
                name: 'æ¸‹è°·ã‚¹ã‚«ã‚¤å±•æœ›å°', 
                location: 'æ¸‹è°·', 
                type: 'sightseeing', 
                rating: 4.7,
                duration: '60',
                description: 'æ±äº¬ã®çµ¶æ™¯ã‚’360åº¦æ¥½ã—ã‚ã‚‹å±•æœ›å°',
                estimatedCost: '2000 JPY',
                tips: 'å¤•æ—¥ã®æ™‚é–“å¸¯ãŒç‰¹ã«ç¾ã—ã„ã§ã™ã€‚'
              }
            ]
          }
        ]
      };
      setTrip(mockTrip);
      setShowMockNotice(true);
    }
  }, [tripId, trips]);
  
  const fetchActivityDetails = async (activity: any) => {
    setIsLoadingDetails(true);
    setSelectedActivity(activity);
    
    try {
      const result = await apiCall('/tripadvisor', {
        method: 'POST',
        body: JSON.stringify({
          location: activity.name
        })
      });
      
      // Check if this is mock data
      if (result.isMockData) {
        setShowMockNotice(true);
      }
      
      // Try to get directions data
      let directionsData = null;
      try {
        const directionsResult = await apiCall('/google-maps', {
          method: 'POST',
          body: JSON.stringify({
            origin: activity.location,
            destination: activity.name,
            type: 'directions'
          })
        });
        directionsData = directionsResult.data || directionsResult;
      } catch (error) {
        console.error('Failed to fetch directions:', error);
      }
      
      setActivityDetails({
        ...(result.data || result),
        directions: directionsData
      });
    } catch (error) {
      const apiError = error as APIError;
      
      // Log error
      globalErrorHandler.handleError(apiError, {
        page: 'TripDetail',
        action: 'fetchActivityDetails',
        userAgent: navigator.userAgent,
        url: window.location.href
      });
      
      console.error('Failed to fetch activity details:', apiError);
      
      // Try fallback data
      try {
        const fallbackData = await autoRecovery.handleServiceFailure('tripadvisor');
        setActivityDetails(fallbackData.data || {
          data: [
            {
              name: activity.name,
              description: 'A popular attraction in Japan.',
              rating: activity.rating || '4.5',
              num_reviews: '1000+',
              photo: {
                images: {
                  original: {
                    url: 'https://images.pexels.com/photos/2070033/pexels-photo-2070033.jpeg'
                  }
                }
              }
            }
          ],
          reviews: {
            data: [
              {
                title: 'Great experience',
                text: 'Wonderful place to visit. Highly recommended!',
                rating: 5,
                user: { username: 'Traveler123' }
              }
            ]
          }
        });
      } catch (fallbackError) {
        console.error('Fallback data failed:', fallbackError);
        setActivityDetails(null);
      }
    } finally {
      setIsLoadingDetails(false);
    }
  };

  // Check if activity should show detailed info for free users
  const shouldShowDetailedInfo = (day: number, time: string): boolean => {
    if (isPremium) return true;
    
    // Day 1: Always show detailed info
    if (day === 1) return true;
    
    // Day 2: Show detailed info only for morning (before 12:00)
    if (day === 2) {
      const hour = parseInt(time.split(':')[0]);
      return hour < 12;
    }
    
    // Day 3+: No detailed info for free users
    return false;
  };

  // Check if activity should be completely hidden for free users
  const shouldHideActivity = (day: number, time: string): boolean => {
    if (isPremium) return false;
    
    // Day 2 afternoon and beyond: Hide for free users
    if (day === 2) {
      const hour = parseInt(time.split(':')[0]);
      return hour >= 12;
    }
    
    // Day 3+: Hide for free users
    return day >= 3;
  };

  const handleTranslate = async () => {
    if (!textToTranslate.trim()) return;
    
    setIsTranslating(true);
    try {
      const result = await apiCall('/openai-chat', {
        method: 'POST',
        body: JSON.stringify({ 
          message: `Translate this text to ${targetLanguage}: ${textToTranslate}`,
          language: targetLanguage,
          context: 'translation'
        })
      });


      console.log('[TripDetail] Translation API response:', result);
      
      if (result.success && result.response && typeof result.response === 'string' && result.response.trim()) {
        setTranslatedText(result.response);
      } else {
        console.warn('[TripDetail] Invalid translation response:', result);
        throw new Error(result.message || 'ç¿»è¨³ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (error) {
      const apiError = error as APIError;
      
      globalErrorHandler.handleError(apiError, {
        page: 'TripDetail',
        action: 'translate',
        userAgent: navigator.userAgent,
        url: window.location.href
      });
      
      console.error('Translation error:', apiError);
      
      if (apiError.code === 'NETWORK_OFFLINE') {
        setTranslatedText('ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒã‚ã‚Šã¾ã›ã‚“ã€‚æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
      } else if (apiError.status === 429) {
        setTranslatedText('ç¿»è¨³ã‚µãƒ¼ãƒ“ã‚¹ãŒæ··é›‘ã—ã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰ãŠè©¦ã—ãã ã•ã„ã€‚');
      } else {
        setTranslatedText('ç¿»è¨³ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
      }
    } finally {
      setIsTranslating(false);
    }
  };

  const getActivityIcon = (type: string) => {
    switch (type) {
      case 'culture': return 'â›©ï¸';
      case 'food': return 'ğŸœ';
      case 'shopping': return 'ğŸ›ï¸';
      case 'transport': return 'âœˆï¸';
      case 'sightseeing': return 'ğŸ™ï¸';
      default: return 'ğŸ“';
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50">
      {/* Header */}
      <header className="bg-white shadow-sm border-b border-gray-200">
        <div className="max-w-7xl mx-auto px-6 py-4">
          <div className="flex items-center justify-between">
            <button
              onClick={() => navigate('/dashboard')}
              className="flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors"
            >
              <ArrowLeft className="w-5 h-5" />
              <span>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹</span>
            </button>
            
            <div className="flex items-center space-x-4">
              <button className="p-2 text-gray-600 hover:text-gray-800 transition-colors">
                <Edit className="w-5 h-5" />
              </button>
              <button 
                onClick={() => navigate(`/share/${tripId}`)}
                className="p-2 text-gray-600 hover:text-gray-800 transition-colors"
              >
                <Share className="w-5 h-5" />
              </button>
              <button className="p-2 text-gray-600 hover:text-gray-800 transition-colors">
                <Download className="w-5 h-5" />
              </button>
            </div>
          </div>
        </div>
      </header>

      <div className="max-w-6xl mx-auto px-6 py-8">
        {/* Mock Data Notice */}
        {showMockNotice && (
          <MockDataNotice 
            onRetry={() => setShowMockNotice(false)}
            className="mb-6"
          />
        )}
        
        {/* Trip Header */}
        <motion.div
          className="bg-white rounded-3xl shadow-lg overflow-hidden mb-8"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8 }}
        >
          <div
            className="h-64 bg-cover bg-center relative"
            style={{ backgroundImage: `url(${trip.image})` }}
          >
            <div className="absolute inset-0 bg-black bg-opacity-40" />
            <div className="absolute bottom-6 left-6 text-white">
              <h1 className="text-4xl font-bold mb-2">{trip.title}</h1>
              <div className="flex items-center space-x-4 text-lg">
                <div className="flex items-center space-x-1">
                  <MapPin className="w-5 h-5" />
                  <span>{trip.destination}</span>
                </div>
                <div className="flex items-center space-x-1">
                  <Calendar className="w-5 h-5" />
                  <span>
                    {new Date(trip.startDate).toLocaleDateString('ja-JP')} - 
                    {new Date(trip.endDate).toLocaleDateString('ja-JP')}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </motion.div>

        {/* Itinerary */}
        <div className="space-y-6">
          {trip.itinerary.map((day, dayIndex) => (
            <motion.div
              key={day.day}
              className="bg-white rounded-3xl shadow-lg overflow-hidden"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.5, delay: dayIndex * 0.1 }}
            >
              <div className="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6">
                <h2 className="text-2xl font-bold">Day {day.day}</h2>
                <p className="text-blue-100">{day.title}</p>
                <p className="text-sm text-blue-200">
                  {new Date(day.date).toLocaleDateString('ja-JP', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                  })}
                </p>
              </div>

              <div className="p-6">
                {day.activities.map((activity, actIndex) => {
                  // Check if activity should be hidden for free users
                  const shouldHide = shouldHideActivity(day.day, activity.time);
                  const showDetailed = shouldShowDetailedInfo(day.day, activity.time);
                  
                  if (shouldHide) {
                    return null;
                  }
                  
                  return (
                  <motion.div
                    key={actIndex}
                    className={`flex items-start space-x-4 py-4 cursor-pointer hover:bg-gray-50 rounded-xl transition-colors ${
                      actIndex !== day.activities.length - 1 ? 'border-b border-gray-100' : ''
                    }`}
                    initial={{ opacity: 0, x: -20 }}
                    animate={{ opacity: 1, x: 0 }}
                    transition={{ duration: 0.3, delay: (dayIndex * 0.1) + (actIndex * 0.05) }}
                    onClick={() => fetchActivityDetails(activity)}
                  >
                    <div className="flex-shrink-0">
                      <div className="w-12 h-12 bg-gradient-to-br from-purple-100 to-blue-100 rounded-full flex items-center justify-center text-xl">
                        {getActivityIcon(activity.type)}
                      </div>
                    </div>
                    
                    <div className="flex-1">
                      <div className="flex items-center space-x-2 mb-1">
                        <Clock className="w-4 h-4 text-gray-400" />
                        <span className="text-sm font-medium text-gray-600">{activity.time}</span>
                        {showDetailed && activity.duration && (
                          <>
                            <span className="text-gray-400">â€¢</span>
                            <span className="text-sm text-gray-600">{activity.duration}åˆ†</span>
                          </>
                        )}
                      </div>
                      <h3 className="font-semibold text-gray-800 mb-1">{activity.name}</h3>
                      
                      {/* Show description for detailed view */}
                      {showDetailed && activity.description && (
                        <p className="text-sm text-gray-600 mb-2">{activity.description}</p>
                      )}
                      
                      <div className="flex items-center space-x-4 text-sm text-gray-600">
                        <div className="flex items-center space-x-1">
                          <MapPin className="w-4 h-4" />
                          <span>{activity.location}</span>
                        </div>
                        {activity.rating && (
                          <div className="flex items-center space-x-1">
                            <Star className="w-4 h-4 text-yellow-500" />
                            <span>{activity.rating}</span>
                          </div>
                        )}
                        {showDetailed && activity.estimatedCost && (
                          <>
                            <span className="text-gray-400">â€¢</span>
                            <span className="text-sm text-gray-600">{activity.estimatedCost}</span>
                          </>
                        )}
                        {/* Navigation Button */}
                        {showDetailed && activity.coordinates && (
                          <button
                            onClick={(e) => {
                              e.stopPropagation();
                              const googleMapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${activity.coordinates.lat},${activity.coordinates.lng}&travelmode=transit`;
                              window.open(googleMapsUrl, '_blank');
                            }}
                            className="flex items-center space-x-1 px-2 py-1 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors text-xs"
                          >
                            <MapPin className="w-3 h-3" />
                            <span>å‘ã‹ã†</span>
                          </button>
                        )}
                      </div>
                      
                      {/* Transport Details */}
                      {showDetailed && activity.transportDetails && (
                        <div className="mt-2 p-2 bg-green-50 rounded-lg">
                          <div className="flex items-center space-x-3 text-xs text-green-700">
                            <span>ğŸšƒ {activity.transportDetails.method}</span>
                            <span>ğŸ“ {activity.transportDetails.distance || activity.transportDetails.line}</span>
                            {activity.transportDetails.transfers !== undefined && (
                              <span>ğŸ”„ ä¹—æ›{activity.transportDetails.transfers}å›</span>
                            )}
                            <span>ğŸš¶ å¾’æ­©{activity.transportDetails.walkingTime}</span>
                          </div>
                        </div>
                      )}
                      
                      {/* Reviews */}
                      {showDetailed && activity.reviews && activity.reviews.length > 0 && (
                        <div className="mt-2 p-2 bg-yellow-50 rounded-lg">
                          <div className="flex items-start space-x-2">
                            <Star className="w-3 h-3 text-yellow-500 mt-0.5" />
                            <div>
                              <p className="text-xs text-yellow-800">"{activity.reviews[0].text}"</p>
                              <p className="text-xs text-yellow-600 mt-1">- {activity.reviews[0].author}</p>
                            </div>
                          </div>
                        </div>
                      )}
                      
                      {/* Show tips for detailed view */}
                      {showDetailed && activity.tips && (
                        <div className="mt-2 p-2 bg-blue-50 rounded-lg">
                          <p className="text-xs text-blue-700">ğŸ’¡ {activity.tips}</p>
                        </div>
                      )}
                    </div>

                    <div className="flex flex-col space-y-2">
                      {showDetailed ? (
                        <button className="p-2 text-blue-600 hover:text-blue-700 transition-colors">
                          <Eye className="w-4 h-4" />
                        </button>
                      ) : (
                        <button className="p-2 text-gray-400 hover:text-gray-600 transition-colors">
                          <Lock className="w-4 h-4" />
                        </button>
                      )}
                    </div>
                  </motion.div>
                  );
                })}
                
                {/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ åˆ¶é™ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ2æ—¥ç›®ã®åˆå¾Œä»¥é™ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãŒã‚ã‚‹å ´åˆï¼‰ */}
                {!isPremium && day.day === 2 && day.activities.some((activity: any) => {
                  const hour = parseInt(activity.time.split(':')[0]);
                  return hour >= 12;
                }) && (
                  <div className="mt-6 p-6 bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl border-2 border-dashed border-purple-300">
                    <div className="text-center">
                      <Sparkles className="w-12 h-12 text-purple-600 mx-auto mb-4" />
                      <h3 className="text-lg font-bold text-purple-800 mb-2">
                        åˆå¾Œã®ãƒ—ãƒ©ãƒ³è©³ç´°ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™å®š
                      </h3>
                      <p className="text-sm text-purple-600 mb-4">
                        2æ—¥ç›®ã®åˆå¾Œä»¥é™ï¼ˆ12:00ä»¥é™ï¼‰ã®è©³ç´°æƒ…å ±ã‚’è¦‹ã‚‹ã«ã¯ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚
                      </p>
                      <div className="mb-4 text-xs text-purple-500">
                        âœ¨ åˆå‰ä¸­ï¼ˆ12:00ã¾ã§ï¼‰ã®è©³ç´°ã¯ç„¡æ–™ã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™
                      </div>
                      <button
                        onClick={() => navigate('/checkout')}
                        className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all"
                      >
                        ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
                      </button>
                    </div>
                  </div>
                )}
                
                {/* 3æ—¥ç›®ä»¥é™ã®åˆ¶é™è¡¨ç¤º */}
                {!isPremium && day.day >= 3 && day.activities.length > 0 && (
                  <div className="p-6 bg-gradient-to-r from-gray-100 to-purple-100 rounded-xl border-2 border-dashed border-gray-300">
                    <div className="text-center">
                      <Lock className="w-8 h-8 text-gray-600 mx-auto mb-2" />
                      <p className="text-sm font-medium text-gray-800">
                        {day.day}æ—¥ç›®ã®ãƒ—ãƒ©ãƒ³ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™å®šã§ã™
                      </p>
                      <p className="text-xs text-gray-600 mt-1">
                        ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦å®Œå…¨ãªæ—…ç¨‹ã‚’ã”è¦§ãã ã•ã„
                      </p>
                    </div>
                  </div>
                )}
              </div>
            </motion.div>
          ))}
          
          {/* æ®‹ã‚Šã®æ—¥ç¨‹ãŒã‚ã‚‹å ´åˆã®åˆ¶é™è¡¨ç¤º */}
          {!isPremium && trip.itinerary.length > 2 && trip.itinerary.slice(2).some((day: any) => day.activities.length > 0) && (
            <motion.div
              className="bg-white rounded-3xl shadow-lg p-8 text-center"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.5, delay: 0.3 }}
            >
              <Sparkles className="w-16 h-16 text-purple-600 mx-auto mb-4" />
              <h2 className="text-2xl font-bold text-gray-800 mb-4">
                æ®‹ã‚Š{trip.itinerary.length - 2}æ—¥é–“ã®ãƒ—ãƒ©ãƒ³ãŒã‚ã‚Šã¾ã™
              </h2>
              <p className="text-gray-600 mb-6">
                ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦ã€å®Œå…¨ãª{trip.itinerary.length}æ—¥é–“ã®æ—…ç¨‹ã‚’ã”è¦§ãã ã•ã„ã€‚
              </p>
              <div className="mb-6 p-4 bg-blue-50 rounded-xl">
                <p className="text-sm text-blue-700">
                  âœ¨ ç¾åœ¨ã€1æ—¥ç›®ã¨2æ—¥ç›®ã®åˆå‰ä¸­ï¼ˆ12:00ã¾ã§ï¼‰ã®è©³ç´°ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™
                </p>
              </div>
              <button
                onClick={() => navigate('/checkout')}
                className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all"
              >
                ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
              </button>
            </motion.div>
          )}
        </div>

        {/* Action Buttons */}
        <motion.div
          className="mt-8 flex justify-center space-x-4"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5, delay: 0.5 }}
        >
          <button 
            onClick={() => navigate(`/trip/${tripId}/edit`)}
            className="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-medium rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all"
          >
            ãƒ—ãƒ©ãƒ³ã‚’ç·¨é›†
          </button>
          <button 
            onClick={() => setShowTranslator(true)}
            className="px-6 py-3 bg-white text-gray-700 font-medium rounded-xl border border-gray-300 hover:bg-gray-50 transition-all"
          >
            <Languages className="w-4 h-4 mr-2 inline-block" />
            ç¿»è¨³ã™ã‚‹
          </button>
          <button 
            className="px-6 py-3 bg-white text-gray-700 font-medium rounded-xl border border-gray-300 hover:bg-gray-50 transition-all"
          >
            PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
          </button>
        </motion.div>
      </div>
      
      {/* Activity Details Modal */}
      <AnimatePresence>
        {selectedActivity && (
          <motion.div
            className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            onClick={() => {
              setSelectedActivity(null);
              setActivityDetails(null);
            }}
          >
            <motion.div
              className="bg-white rounded-3xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"
              initial={{ scale: 0.9, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.9, opacity: 0 }}
              transition={{ duration: 0.3 }}
              onClick={(e) => e.stopPropagation()}
            >
              {isLoadingDetails ? (
                <div className="py-12 text-center">
                  <div className="w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                  <p className="text-gray-600">è©³ç´°ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
                </div>
              ) : activityDetails ? (
                <>
                  {/* Header */}
                  <div className="mb-6">
                    {activityDetails.data?.[0]?.photo?.images?.original?.url && (
                      <div 
                        className="h-48 bg-cover bg-center rounded-xl mb-4"
                        style={{ backgroundImage: `url(${activityDetails.data[0].photo.images.original.url})` }}
                      />
                    )}
                    <h2 className="text-2xl font-bold text-gray-800">{selectedActivity.name}</h2>
                    <div className="flex items-center space-x-2 mt-2">
                      <div className="flex items-center">
                        <Star className="w-4 h-4 text-yellow-500" />
                        <span className="ml-1 text-gray-700">{activityDetails.data?.[0]?.rating || selectedActivity.rating || '4.5'}</span>
                      </div>
                      <span className="text-gray-500">â€¢</span>
                      <div className="flex items-center">
                        <MapPin className="w-4 h-4 text-gray-500" />
                        <span className="ml-1 text-gray-700">{selectedActivity.location}</span>
                      </div>
                      <span className="text-gray-500">â€¢</span>
                      <div className="flex items-center">
                        <Clock className="w-4 h-4 text-gray-500" />
                        <span className="ml-1 text-gray-700">{selectedActivity.time}</span>
                      </div>
                    </div>
                  </div>
                  
                  {/* Description */}
                  <div className="mb-6">
                    <h3 className="text-lg font-semibold text-gray-800 mb-2">èª¬æ˜</h3>
                    <p className="text-gray-700">
                      {activityDetails.data?.[0]?.description || selectedActivity.description || 'è©³ç´°æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“ã€‚'}
                    </p>
                    
                    {/* Show additional details if available */}
                    {selectedActivity.estimatedCost && (
                      <div className="mt-4 grid md:grid-cols-2 gap-4 text-sm">
                        <div>
                          <span className="font-medium text-gray-700">äºˆç®—ç›®å®‰:</span>
                          <br />
                          <span className="text-gray-600">{selectedActivity.estimatedCost}</span>
                        </div>
                        {selectedActivity.duration && (
                          <div>
                            <span className="font-medium text-gray-700">æ‰€è¦æ™‚é–“:</span>
                            <br />
                            <span className="text-gray-600">{selectedActivity.duration}åˆ†</span>
                          </div>
                        )}
                      </div>
                    )}
                    
                    {/* Show tips if available */}
                    {selectedActivity.tips && (
                      <div className="mt-4 p-3 bg-blue-50 rounded-lg">
                        <h4 className="font-medium text-blue-800 mb-1">ğŸ’¡ ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ</h4>
                        <p className="text-sm text-blue-700">{selectedActivity.tips}</p>
                      </div>
                    )}
                  </div>
                  
                  {/* Access Information */}
                  {activityDetails.directions?.routes?.[0]?.legs?.[0]?.steps && (
                    <div className="mb-6">
                      <h3 className="text-lg font-semibold text-gray-800 mb-2">ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•</h3>
                      <div className="bg-gray-50 rounded-xl p-4">
                        {activityDetails.directions.routes[0].legs[0].steps.map((step: any, index: number) => (
                          <div key={index} className="mb-2 last:mb-0">
                            <div dangerouslySetInnerHTML={{ __html: step.html_instructions }} className="text-gray-700" />
                            <div className="flex items-center space-x-4 text-sm text-gray-500 mt-1">
                              <span>{step.distance?.text}</span>
                              <span>{step.duration?.text}</span>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}
                  
                  {/* Reviews */}
                  {activityDetails.reviews?.data && activityDetails.reviews.data.length > 0 && (
                    <div className="mb-6">
                      <h3 className="text-lg font-semibold text-gray-800 mb-2">ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
                      <div className="space-y-4">
                        {activityDetails.reviews.data.slice(0, 3).map((review: any, index: number) => (
                          <div key={index} className="bg-gray-50 rounded-xl p-4">
                            <div className="flex items-center justify-between mb-2">
                              <div className="flex items-center space-x-2">
                                <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                  <Users className="w-4 h-4 text-blue-600" />
                                </div>
                                <span className="font-medium text-gray-800">{review.user?.username || 'Anonymous'}</span>
                              </div>
                              <div className="flex">
                                {Array.from({ length: review.rating || 5 }).map((_, i) => (
                                  <Star key={i} className="w-4 h-4 text-yellow-500" fill="currentColor" />
                                ))}
                              </div>
                            </div>
                            <h4 className="font-medium text-gray-800">{review.title || 'Review'}</h4>
                            <p className="text-gray-600 text-sm">{review.text}</p>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}
                  
                  {/* External Links */}
                  {activityDetails.data?.[0]?.web_url && (
                    <div className="flex justify-end">
                      <a
                        href={activityDetails.data[0].web_url}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="flex items-center space-x-2 text-blue-600 hover:text-blue-700"
                      >
                        <ExternalLink className="w-4 h-4" />
                        <span>TripAdvisorã§è©³ç´°ã‚’è¦‹ã‚‹</span>
                      </a>
                    </div>
                  )}
                </>
              ) : (
                <div className="py-12 text-center">
                  <p className="text-gray-600">è©³ç´°æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚</p>
                </div>
              )}
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
      
      {/* Translation Modal */}
      <AnimatePresence>
        {showTranslator && (
          <motion.div
            className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            <motion.div
              className="bg-white rounded-3xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"
              initial={{ scale: 0.9, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.9, opacity: 0 }}
              transition={{ duration: 0.3 }}
            >
              <div className="flex justify-between items-center mb-4">
                <h2 className="text-2xl font-bold text-gray-800">ç¿»è¨³ãƒ„ãƒ¼ãƒ«</h2>
                <button
                  onClick={() => setShowTranslator(false)}
                  className="p-2 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-100"
                >
                  <X className="w-5 h-5" />
                </button>
              </div>
              
              <div className="space-y-4">
                {/* Language Selection */}
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    ç¿»è¨³å…ˆè¨€èª:
                  </label>
                  <div className="flex items-center space-x-2">
                    <Globe className="w-5 h-5 text-gray-400" />
                    <select
                      value={targetLanguage}
                      onChange={(e) => setTargetLanguage(e.target.value)}
                      className="w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                    >
                      <option value="en">English</option>
                      <option value="zh">ä¸­æ–‡</option>
                      <option value="ko">í•œêµ­ì–´</option>
                      <option value="es">EspaÃ±ol</option>
                      <option value="fr">FranÃ§ais</option>
                      <option value="de">Deutsch</option>
                    </select>
                  </div>
                </div>
                
                {/* Input */}
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    ç¿»è¨³ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ:
                  </label>
                  <textarea
                    value={textToTranslate}
                    onChange={(e) => setTextToTranslate(e.target.value)}
                    placeholder="ç¿»è¨³ã—ãŸã„ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."
                    className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"
                    rows={5}
                  />
                </div>
                
                <button
                  onClick={handleTranslate}
                  disabled={!textToTranslate.trim() || isTranslating}
                  className="w-full flex items-center justify-center space-x-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50"
                >
                  {isTranslating ? (
                    <>
                      <Loader className="w-5 h-5 animate-spin" />
                      <span>ç¿»è¨³ä¸­...</span>
                    </>
                  ) : (
                    <>
                      <Languages className="w-5 h-5" />
                      <span>ç¿»è¨³ã™ã‚‹</span>
                    </>
                  )}
                </button>
                
                {/* Output */}
                {translatedText && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      ç¿»è¨³çµæœ:
                    </label>
                    <div className="p-4 bg-gray-50 rounded-xl border border-gray-200">
                      <p className="whitespace-pre-wrap">{translatedText}</p>
                    </div>
                  </div>
                )}
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
};

export default TripDetail;
</file>

<file path="src/utils/apiMockData.ts">
// Mock data for API fallbacks when services are unavailable
export interface MockDataResponse {
  success: boolean;
  data: any;
  isMockData: boolean;
  message: string;
}

// OpenAI Chat Mock Data
export const mockChatResponse = (): MockDataResponse => ({
  success: true,
  data: {
    response: "ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€ç¾åœ¨AIã‚µãƒ¼ãƒ“ã‚¹ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚ã“ã¡ã‚‰ã¯äº‹å‰ã«æº–å‚™ã•ã‚ŒãŸå›ç­”ã§ã™ã€‚æ—¥æœ¬æ—…è¡Œã«ã¤ã„ã¦åŸºæœ¬çš„ãªæƒ…å ±ã‚’ãŠæ‰‹ä¼ã„ã§ãã¾ã™ã€‚"
  },
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
});

// OpenAI Vision Mock Data
export const mockVisionResponse = (): MockDataResponse => ({
  success: true,
  data: {
    translation: "ç”»åƒç¿»è¨³ã‚µãƒ¼ãƒ“ã‚¹ãŒç¾åœ¨åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"
  },
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
});

// OpenAI Generate Mock Data
export const mockGenerateResponse = (): MockDataResponse => {
  const plans = [
    {
      theme: "æ–‡åŒ–ãƒ»æ­´å²é‡è¦–ãƒ—ãƒ©ãƒ³",
      description: "ä¼çµ±çš„ãªå¯ºé™¢ã¨æ­´å²çš„å»ºé€ ç‰©ã‚’ä¸­å¿ƒã¨ã—ãŸæ–‡åŒ–ä½“é¨“",
      destination: "æ±äº¬",
      duration: "3æ—¥é–“",
      totalEstimatedCost: "Â¥85,000",
      itinerary: [
        {
          day: 1,
          date: new Date().toISOString().split('T')[0],
          title: "æ±äº¬åˆ°ç€ãƒ»æµ…è‰æ–‡åŒ–æ¢ç´¢",
          activities: [
            {
              id: "cultural_act_1",
              time: "10:00",
              name: "ç¾½ç”°ç©ºæ¸¯åˆ°ç€",
              location: "ç¾½ç”°ç©ºæ¸¯",
              coordinates: { lat: 35.5494, lng: 139.7798 },
              type: "transport",
              description: "æ±äº¬ã¸ã®ç„é–¢å£ã€å›½éš›ç·šã‚¿ãƒ¼ãƒŸãƒŠãƒ«",
              estimatedCost: "0 JPY",
              duration: "30",
              rating: 4.0,
              tips: "åˆ°ç€å¾Œã€äº¬æ€¥ç·šã§æµ…è‰æ–¹é¢ã¸å‘ã‹ã„ã¾ã™ã€‚ICã‚«ãƒ¼ãƒ‰ã®è³¼å…¥ã‚’ãŠå¿˜ã‚Œãªãã€‚"
            },
            {
              id: "cultural_transport_1",
              time: "10:30",
              name: "ç¾½ç”°ç©ºæ¸¯ â†’ æµ…è‰é§…",
              location: "äº¬æ€¥ç·šãƒ»éƒ½å–¶æµ…è‰ç·š",
              coordinates: { lat: 35.7101, lng: 139.7956 },
              type: "transport",
              description: "äº¬æ€¥ç·šãƒ»éƒ½å–¶æµ…è‰ç·šã§æµ…è‰é§…ã¾ã§ç´„45åˆ†ã®é›»è»Šç§»å‹•",
              estimatedCost: "410 JPY",
              duration: "45",
              rating: 4.2,
              tips: "ICã‚«ãƒ¼ãƒ‰ï¼ˆSuica/PASMOï¼‰ãŒä¾¿åˆ©ã§ã™ã€‚ä¹—ã‚Šæ›ãˆã¯1å›ã§ã™ã€‚",
              transportDetails: {
                method: "é›»è»Š",
                line: "äº¬æ€¥ç·šâ†’éƒ½å–¶æµ…è‰ç·š",
                transfers: 1,
                walkingTime: "5åˆ†"
              }
            },
            {
              id: "cultural_act_2",
              time: "11:30",
              name: "æµ…è‰å¯ºå‚æ‹",
              location: "æµ…è‰",
              coordinates: { lat: 35.7148, lng: 139.7967 },
              type: "culture",
              description: "645å¹´å‰µå»ºã®æ±äº¬æœ€å¤ã®å¯ºé™¢ã€‚é›·é–€ï¼ˆé¢¨é›·ç¥é–€ï¼‰ã¯æµ…è‰ã®ã‚·ãƒ³ãƒœãƒ«ã§ã€é«˜ã•3.9mã€é‡ã•700kgã®å¤§æç¯ãŒæœ‰åã€‚æœ¬å ‚ã§ã¯è¦³éŸ³æ§˜ã«å‚æ‹ã—ã€ãŠã¿ãã˜ã‚’å¼•ãã“ã¨ãŒã§ãã¾ã™ã€‚",
              estimatedCost: "0 JPY",
              duration: "90",
              rating: 4.8,
              tips: "é›·é–€ã§ã®è¨˜å¿µæ’®å½±ã¯å¿…é ˆï¼æœ¬å ‚ã§ã®ãŠå‚ã‚Šã¯äºŒç¤¼äºŒæ‹æ‰‹ä¸€ç¤¼ã§ã€‚ãŠã¿ãã˜ã¯æ—¥æœ¬èªãƒ»è‹±èªå¯¾å¿œã§ã™ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "é›·é–€ã®è¿«åŠ›ã«åœ§å€’ã•ã‚Œã¾ã—ãŸã€‚æœ¬å ‚ã§ã®å‚æ‹ã¯å¿ƒãŒæ´—ã‚ã‚Œã‚‹æ€ã„ã§ã—ãŸã€‚",
                  author: "æ–‡åŒ–æ„›å¥½å®¶"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      theme: "ã‚°ãƒ«ãƒ¡ãƒ»é£Ÿã¹æ­©ããƒ—ãƒ©ãƒ³",
      description: "æ±äº¬ã®ç¾å‘³ã—ã„ã‚°ãƒ«ãƒ¡ã‚’ä¸­å¿ƒã¨ã—ãŸé£Ÿæ–‡åŒ–ä½“é¨“",
      destination: "æ±äº¬",
      duration: "3æ—¥é–“", 
      totalEstimatedCost: "Â¥95,000",
      itinerary: [
        {
          day: 1,
          date: new Date().toISOString().split('T')[0],
          title: "æ±äº¬åˆ°ç€ãƒ»ç¯‰åœ°ã‚°ãƒ«ãƒ¡æ¢ç´¢",
          activities: [
            {
              id: "gourmet_act_1",
              time: "10:00",
              name: "ç¾½ç”°ç©ºæ¸¯åˆ°ç€",
              location: "ç¾½ç”°ç©ºæ¸¯",
              coordinates: { lat: 35.5494, lng: 139.7798 },
              type: "transport",
              description: "æ±äº¬ã¸ã®ç„é–¢å£",
              estimatedCost: "0 JPY",
              duration: "30",
              rating: 4.0,
              tips: "åˆ°ç€å¾Œã€æ±äº¬ãƒ¢ãƒãƒ¬ãƒ¼ãƒ«ã§æ–°æ©‹çµŒç”±ç¯‰åœ°æ–¹é¢ã¸ã€‚"
            },
            {
              id: "gourmet_act_2",
              time: "11:30",
              name: "ç¯‰åœ°å ´å¤–å¸‚å ´",
              location: "ç¯‰åœ°",
              coordinates: { lat: 35.6654, lng: 139.7707 },
              type: "food",
              description: "æ–°é®®ãªæµ·é®®ã¨ã‚°ãƒ«ãƒ¡ã®è–åœ°ã€‚ãƒã‚°ãƒ­ã®è§£ä½“ã‚·ãƒ§ãƒ¼ã‚„è·äººã®æŠ€ã‚’é–“è¿‘ã§è¦‹å­¦ã§ãã¾ã™ã€‚",
              estimatedCost: "3500 JPY",
              duration: "120",
              rating: 4.7,
              tips: "æœæ—©ã„æ™‚é–“ï¼ˆ6:00-9:00ï¼‰ãŒæœ€ã‚‚æ´»æ°—ãŒã‚ã‚Šã¾ã™ã€‚ç‰å­ç„¼ãã®ã€Œå±±é•·ã€ã¯å¿…é£Ÿï¼"
            }
          ]
        }
      ]
    },
    {
      theme: "ç¾ä»£ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒ»ã‚¨ãƒ³ã‚¿ãƒ¡ãƒ—ãƒ©ãƒ³", 
      description: "æœ€æ–°ã®æ—¥æœ¬ãƒãƒƒãƒ—ã‚«ãƒ«ãƒãƒ£ãƒ¼ã¨ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆä½“é¨“",
      destination: "æ±äº¬",
      duration: "3æ—¥é–“",
      totalEstimatedCost: "Â¥78,000",
      itinerary: [
        {
          day: 1,
          date: new Date().toISOString().split('T')[0],
          title: "æ±äº¬åˆ°ç€ãƒ»ç§‹è‘‰åŸã‚¢ãƒ‹ãƒ¡æ–‡åŒ–",
          activities: [
            {
              id: "anime_act_1",
              time: "10:00",
              name: "ç¾½ç”°ç©ºæ¸¯åˆ°ç€",
              location: "ç¾½ç”°ç©ºæ¸¯",
              coordinates: { lat: 35.5494, lng: 139.7798 },
              type: "transport",
              description: "æ±äº¬ã¸ã®ç„é–¢å£",
              estimatedCost: "0 JPY",
              duration: "30",
              rating: 4.0,
              tips: "åˆ°ç€å¾Œã€äº¬æ€¥ç·šã§ç§‹è‘‰åŸæ–¹é¢ã¸ã€‚"
            },
            {
              id: "anime_act_2",
              time: "11:30",
              name: "ç§‹è‘‰åŸé›»æ°—è¡—",
              location: "ç§‹è‘‰åŸ",
              coordinates: { lat: 35.7022, lng: 139.7744 },
              type: "shopping",
              description: "ä¸–ç•Œæœ€å¤§ã®é›»æ°—è¡—ã€‚ã‚¢ãƒ‹ãƒ¡ã€ãƒãƒ³ã‚¬ã€ã‚²ãƒ¼ãƒ ã€ãƒ•ã‚£ã‚®ãƒ¥ã‚¢ãªã©ã‚ªã‚¿ã‚¯æ–‡åŒ–ã®è–åœ°ã€‚",
              estimatedCost: "5000 JPY",
              duration: "150",
              rating: 4.6,
              tips: "ãƒ¨ãƒ‰ãƒã‚·ã‚«ãƒ¡ãƒ©ã€ãƒ“ãƒƒã‚¯ã‚«ãƒ¡ãƒ©ã§æœ€æ–°ã‚¬ã‚¸ã‚§ãƒƒãƒˆã€‚ãƒ¡ã‚¤ãƒ‰ã‚«ãƒ•ã‚§ä½“é¨“ã‚‚ï¼"
            }
          ]
        }
      ]
    }
  ];

  return {
    success: true,
    data: {
      plans,
      itinerary: [
        {
          day: 1,
          date: new Date().toISOString().split('T')[0],
          title: "æ±äº¬åˆ°ç€ãƒ»æµ…è‰æ¢ç´¢",
          activities: [
            {
              id: "act_1",
              time: "10:00",
              name: "ç¾½ç”°ç©ºæ¸¯åˆ°ç€",
              location: "ç¾½ç”°ç©ºæ¸¯",
              coordinates: { lat: 35.5494, lng: 139.7798 },
              type: "transport",
              description: "æ±äº¬ã¸ã®ç„é–¢å£",
              estimatedCost: "0 JPY",
              duration: "30",
              rating: 4.0,
              tips: "åˆ°ç€å¾Œã€äº¬æ€¥ç·šã§æµ…è‰æ–¹é¢ã¸å‘ã‹ã„ã¾ã™ã€‚"
            },
            {
              id: "act_1_transport",
              time: "10:30",
              name: "ç¾½ç”°ç©ºæ¸¯ â†’ æµ…è‰é§…",
              location: "äº¬æ€¥ç·šãƒ»éƒ½å–¶æµ…è‰ç·š",
              coordinates: { lat: 35.7101, lng: 139.7956 },
              type: "transport",
              description: "äº¬æ€¥ç·šãƒ»éƒ½å–¶æµ…è‰ç·šã§æµ…è‰é§…ã¾ã§ç´„45åˆ†ã®é›»è»Šç§»å‹•",
              estimatedCost: "410 JPY",
              duration: "45",
              rating: 4.2,
              tips: "IC ã‚«ãƒ¼ãƒ‰ï¼ˆSuica/PASMOï¼‰ãŒä¾¿åˆ©ã§ã™ã€‚ä¹—ã‚Šæ›ãˆã¯1å›ã§ã™ã€‚",
              transportDetails: {
                method: "é›»è»Š",
                line: "äº¬æ€¥ç·šâ†’éƒ½å–¶æµ…è‰ç·š",
                transfers: 1,
                walkingTime: "5åˆ†"
              }
            },
            {
              id: "act_2", 
              time: "11:30",
              name: "æµ…è‰å¯ºå‚æ‹",
              location: "æµ…è‰",
              coordinates: { lat: 35.7148, lng: 139.7967 },
              type: "culture",
              description: "645å¹´å‰µå»ºã®æ±äº¬æœ€å¤ã®å¯ºé™¢ã€‚é›·é–€ï¼ˆé¢¨é›·ç¥é–€ï¼‰ã¯æµ…è‰ã®ã‚·ãƒ³ãƒœãƒ«ã§ã€é«˜ã•3.9mã€é‡ã•700kgã®å¤§æç¯ãŒæœ‰åã€‚æœ¬å ‚ã§ã¯è¦³éŸ³æ§˜ã«å‚æ‹ã—ã€ãŠã¿ãã˜ã‚’å¼•ãã“ã¨ãŒã§ãã¾ã™ã€‚",
              estimatedCost: "0 JPY",
              duration: "90",
              rating: 4.8,
              tips: "é›·é–€ã§ã®è¨˜å¿µæ’®å½±ã¯å¿…é ˆï¼æœ¬å ‚ã§ã®ãŠå‚ã‚Šã¯äºŒç¤¼äºŒæ‹æ‰‹ä¸€ç¤¼ã§ã€‚ãŠã¿ãã˜ã¯æ—¥æœ¬èªãƒ»è‹±èªå¯¾å¿œã§ã™ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "é›·é–€ã®è¿«åŠ›ã«åœ§å€’ã•ã‚Œã¾ã—ãŸã€‚æœ¬å ‚ã§ã®å‚æ‹ã¯å¿ƒãŒæ´—ã‚ã‚Œã‚‹æ€ã„ã§ã—ãŸã€‚",
                  author: "æ–‡åŒ–æ„›å¥½å®¶"
                }
              ]
            },
            {
              id: "act_2_lunch",
              time: "13:00",
              name: "æµ…è‰ä»ŠåŠï¼ˆæ˜¼é£Ÿï¼‰",
              location: "æµ…è‰",
              coordinates: { lat: 35.7142, lng: 139.7965 },
              type: "food",
              description: "æ˜æ²»28å¹´å‰µæ¥­ã®è€èˆ—ã™ãç„¼ãåº—ã€‚æœ€é«˜ç´šã®é»’æ¯›å’Œç‰›ã‚’ä½¿ã£ãŸçµ¶å“ã™ãç„¼ãã§ã€æµ…è‰ã®ä¼çµ±ã®å‘³ã‚’å ªèƒ½ã§ãã¾ã™ã€‚ãƒ©ãƒ³ãƒã‚»ãƒƒãƒˆã¯æ¯”è¼ƒçš„ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«ã€‚",
              estimatedCost: "3,500 JPY",
              duration: "60",
              rating: 4.7,
              tips: "ãƒ©ãƒ³ãƒã®ã€Œã™ãç„¼ãå¾¡è†³ã€ãŒãŠã™ã™ã‚ã€‚å¤œã‚ˆã‚Šæ‰‹é ƒãªä¾¡æ ¼ã§æœ¬æ ¼çš„ãªå‘³ã‚’æ¥½ã—ã‚ã¾ã™ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "ãŠè‚‰ãŒå£ã®ä¸­ã§ã¨ã‚ã‘ã¾ã—ãŸã€‚è€èˆ—ã®æ ¼å¼ã¨å‘³ã«æ„Ÿå‹•ï¼",
                  author: "ã‚°ãƒ«ãƒ¡æ¢æ¤œå®¶"
                }
              ]
            },
            {
              id: "act_3",
              time: "14:00", 
              name: "ä»²è¦‹ä¸–é€šã‚Šæ•£ç­–",
              location: "æµ…è‰",
              coordinates: { lat: 35.7148, lng: 139.7967 },
              type: "shopping",
              description: "æ±Ÿæˆ¸æ™‚ä»£ã‹ã‚‰ç¶šãæ—¥æœ¬æœ€å¤ã®å•†åº—è¡—ï¼ˆç´„250mï¼‰ã€‚89åº—èˆ—ãŒè»’ã‚’é€£ã­ã€äººå½¢ç„¼ãã€é›·ãŠã“ã—ã€æ‰‡å­ã€æ‰‹ã¬ãã„ãªã©ä¼çµ±çš„ãªå’Œé›‘è²¨ã¨ã‚°ãƒ«ãƒ¡ãŒæ¥½ã—ã‚ã¾ã™ã€‚",
              estimatedCost: "2,500 JPY",
              duration: "120",
              rating: 4.6,
              tips: "äººå½¢ç„¼ãã¯ã€Œæœ¨æ‘å®¶æœ¬åº—ã€ã€é›·ãŠã“ã—ã¯ã€Œå¸¸ç›¤å ‚ã€ãŒè€èˆ—ã€‚é£Ÿã¹æ­©ãã—ãªãŒã‚‰å®è”µé–€ã¾ã§æ­©ãã¾ã—ã‚‡ã†ã€‚",
              reviews: [
                {
                  rating: 4,
                  text: "äººå½¢ç„¼ãã®å‡ºæ¥ç«‹ã¦ãŒæœ€é«˜ï¼ãŠåœŸç”£é¸ã³ã‚‚æ¥½ã—ã‹ã£ãŸã§ã™ã€‚",
                  author: "ãŠåœŸç”£ãƒãƒ³ã‚¿ãƒ¼"
                }
              ]
            },
            {
              id: "act_4",
              time: "16:30",
              name: "éš…ç”°å·ã‚¯ãƒ«ãƒ¼ã‚º",
              location: "æµ…è‰",
              coordinates: { lat: 35.7101, lng: 139.8107 },
              type: "sightseeing", 
              description: "æµ…è‰ã€œãŠå°å ´é–“ã®æ°´ä¸Šãƒã‚¹ã€‚éš…ç”°å·ã‹ã‚‰è¦‹ã‚‹æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ï¼ˆ634mï¼‰ã€ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ–ãƒªãƒƒã‚¸ã€12ã®æ­´å²çš„ãªæ©‹æ¢ã‚’æ°´ä¸Šã‹ã‚‰çœºã‚ã‚‹40åˆ†ã®èˆ¹æ—…ã€‚",
              estimatedCost: "1040 JPY",
              duration: "40",
              rating: 4.7,
              tips: "å³å´ã®å¸­ãŒãŠã™ã™ã‚ï¼æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ãŒã‚ˆãè¦‹ãˆã¾ã™ã€‚èˆ¹å†…ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ã¯æ—¥è‹±å¯¾å¿œã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "æ°´ä¸Šã‹ã‚‰è¦‹ã‚‹æ±äº¬ã¯åˆ¥ä¸–ç•Œï¼ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ã®è¿«åŠ›ã«æ„Ÿå‹•ã—ã¾ã—ãŸã€‚",
                  author: "ã‚¯ãƒ«ãƒ¼ã‚ºæ„›å¥½å®¶"
                }
              ]
            },
            {
              id: "act_4_transport",
              time: "17:30",
              name: "ãŠå°å ´ â†’ æµ…è‰é§…",
              location: "ã‚†ã‚Šã‹ã‚‚ã‚ãƒ»éƒ½å–¶æµ…è‰ç·š",
              coordinates: { lat: 35.7101, lng: 139.7956 },
              type: "transport",
              description: "ã‚†ã‚Šã‹ã‚‚ã‚æ–°æ©‹é§…çµŒç”±ã§æµ…è‰é§…ã¾ã§ç´„35åˆ†ã®é›»è»Šç§»å‹•",
              estimatedCost: "320 JPY",
              duration: "35",
              rating: 4.1,
              tips: "ã‚†ã‚Šã‹ã‚‚ã‚ã¯ç„¡äººé‹è»¢ã§æ™¯è‰²ãŒè‰¯ãè¦‹ãˆã¾ã™ã€‚",
              transportDetails: {
                method: "é›»è»Š",
                line: "ã‚†ã‚Šã‹ã‚‚ã‚â†’JRå±±æ‰‹ç·šâ†’éƒ½å–¶æµ…è‰ç·š",
                transfers: 2,
                walkingTime: "8åˆ†"
              }
            },
            {
              id: "act_5",
              time: "18:30",
              name: "è€èˆ—å¤©ã·ã‚‰ã€Œå¤§é»’å®¶ã€ï¼ˆå¤•é£Ÿï¼‰",
              location: "æµ…è‰",
              coordinates: { lat: 35.7145, lng: 139.7962 },
              type: "food",
              description: "1887å¹´å‰µæ¥­ã€137å¹´ã®æ­´å²ã‚’èª‡ã‚‹æ±Ÿæˆ¸å‰å¤©ã·ã‚‰ã®è€èˆ—ã€‚4ä»£ç›®ãŒå®ˆã‚Šç¶šã‘ã‚‹ä¼çµ±ã®æŠ€æ³•ã§ã€è»Šæµ·è€ã€ç©´å­ã€é‡èœã®å¤©ã·ã‚‰ã‚’èƒ¡éº»æ²¹ã§ã‚«ãƒ©ãƒƒã¨æšã’ã¾ã™ã€‚",
              estimatedCost: "4500 JPY", 
              duration: "90",
              rating: 4.8,
              tips: "ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å¸­ã§è·äººã®æŠ€ã‚’é–“è¿‘ã§ï¼æµ·è€å¤©ï¼ˆ1,200å††ï¼‰ã¨ç©´å­å¤©ï¼ˆ1,000å††ï¼‰ã¯çµ¶å¯¾æ³¨æ–‡ã€‚å¤©ã¤ã‚†ã¯ç”˜ã‚ã®æ±Ÿæˆ¸å‰ã‚¹ã‚¿ã‚¤ãƒ«ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "137å¹´ã®ä¼çµ±ã‚’æ„Ÿã˜ã‚‹æœ¬æ ¼çš„ãªæ±Ÿæˆ¸å‰å¤©ã·ã‚‰ã€‚è·äººã•ã‚“ã®æŠ€è¡“ã«æ„Ÿå‹•ã—ã¾ã—ãŸã€‚",
                  author: "å¤©ã·ã‚‰æ„›å¥½å®¶"
                }
              ]
            }
          ]
        },
        {
          day: 2,
          date: new Date(Date.now() + 86400000).toISOString().split('T')[0],
          title: "æ¸‹è°·ãƒ»åŸå®¿ã‚«ãƒ«ãƒãƒ£ãƒ¼ä½“é¨“",
          activities: [
            {
              id: "act_6",
              time: "09:00",
              name: "æ˜æ²»ç¥å®®å‚æ‹",
              location: "åŸå®¿",
              coordinates: { lat: 35.6763, lng: 139.6993 },
              type: "culture",
              description: "1920å¹´å‰µå»ºã€æ˜æ²»å¤©çš‡ã¨æ˜­æ†²çš‡å¤ªåã‚’ç¥€ã‚‹ç¥ç¤¾ã€‚70ä¸‡ã¡ã®äººå·¥æ—ã€Œæ˜æ²»ç¥å®®ã®æ£®ã€ã«å›²ã¾ã‚Œã€éƒ½å¿ƒã¨ã¯æ€ãˆãªã„é™å¯‚ãªç©ºé–“ã€‚å¹´é–“å‚æ‹è€…æ•°ã¯æ—¥æœ¬ä¸€ã®ç´„1000ä¸‡äººã€‚",
              estimatedCost: "0 JPY",
              duration: "90",
              rating: 4.9,
              tips: "å—å‚é“ï¼ˆåŸå®¿é§…å´ï¼‰ã‹ã‚‰å…¥ã‚‹ã®ãŒä¸€èˆ¬çš„ã€‚å¤§é³¥å±…ã¯æœ¨é€ ã§ã¯æ—¥æœ¬ä¸€ã®å¤§ãã•ã€‚å¾¡æœ±å°ã¯500å††ã§ã™ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "éƒ½å¿ƒã«ã“ã‚“ãªé™å¯‚ãªæ£®ãŒã‚ã‚‹ã¨ã¯ï¼å¿ƒãŒæ´—ã‚ã‚Œã‚‹ç¥è–ãªä½“é¨“ã§ã—ãŸã€‚",
                  author: "ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«æ¢æ±‚è€…"
                }
              ]
            },
            {
              id: "act_6_transport",
              time: "10:45",
              name: "æ˜æ²»ç¥å®®å‰ â†’ ç«¹ä¸‹é€šã‚Š",
              location: "å¾’æ­©ç§»å‹•",
              coordinates: { lat: 35.6702, lng: 139.7016 },
              type: "transport",
              description: "æ˜æ²»ç¥å®®å‰é§…ã‹ã‚‰ç«¹ä¸‹é€šã‚Šå…¥å£ã¾ã§å¾’æ­©3åˆ†ã®çŸ­è·é›¢ç§»å‹•",
              estimatedCost: "0 JPY",
              duration: "3",
              rating: 4.0,
              tips: "JRåŸå®¿é§…ã®ç«¹ä¸‹å£ãŒæœ€å¯„ã‚Šã§ã™ã€‚",
              transportDetails: {
                method: "å¾’æ­©",
                distance: "200m",
                walkingTime: "3åˆ†"
              }
            },
            {
              id: "act_7",
              time: "11:00",
              name: "ç«¹ä¸‹é€šã‚Šæ•£ç­–",
              location: "åŸå®¿",
              coordinates: { lat: 35.6702, lng: 139.7016 },
              type: "shopping",
              description: "å…¨é•·350mã®æ—¥æœ¬ãƒãƒƒãƒ—ã‚«ãƒ«ãƒãƒ£ãƒ¼ã®è–åœ°ã€‚åŸå®¿ç³»ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã€ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚°ãƒƒã‚ºã€ã‚¯ãƒ¬ãƒ¼ãƒ—åº—ãªã©ç´„400åº—èˆ—ãŒå¯†é›†ã€‚é€±æœ«ã¯æ­©è¡Œè€…å¤©å›½ã«ãªã‚Šã¾ã™ã€‚",
              estimatedCost: "3,500 JPY",
              duration: "120",
              rating: 4.5,
              tips: "ã€Œãƒãƒªã‚ªãƒ³ã‚¯ãƒ¬ãƒ¼ãƒ—ã€ã®åŸå®¿ã‚¯ãƒ¬ãƒ¼ãƒ—ï¼ˆ500å††ï¼‰ã¯å¿…é£Ÿï¼ã€ŒDAISOåŸå®¿åº—ã€ã¯100å††ã‚·ãƒ§ãƒƒãƒ—ã®è–åœ°ã§ã™ã€‚",
              reviews: [
                {
                  rating: 4,
                  text: "ã‚«ãƒ©ãƒ•ãƒ«ã§æ¥½ã—ã„ï¼ã‚¯ãƒ¬ãƒ¼ãƒ—ãŒç¾å‘³ã—ãã¦ã€è‹¥è€…ã®æ–‡åŒ–ã‚’æ„Ÿã˜ã‚‰ã‚Œã¾ã—ãŸã€‚",
                  author: "ãƒãƒƒãƒ—ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒ•ã‚¡ãƒ³"
                }
              ]
            },
            {
              id: "act_7_lunch",
              time: "13:00",
              name: "bills è¡¨å‚é“ï¼ˆæ˜¼é£Ÿï¼‰",
              location: "è¡¨å‚é“",
              coordinates: { lat: 35.6657, lng: 139.7085 },
              type: "food",
              description: "ã‚·ãƒ‰ãƒ‹ãƒ¼ç™ºç¥¥ã®ã€Œä¸–ç•Œä¸€ã®æœé£Ÿã€ã§æœ‰åãªã‚«ãƒ•ã‚§ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã€‚ãµã‚ãµã‚ã®ãƒªã‚³ãƒƒã‚¿ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ã¨ã‚ªãƒ¼ã‚¬ãƒ‹ãƒƒã‚¯é£Ÿæã‚’ä½¿ã£ãŸæ–™ç†ãŒè‡ªæ…¢ã€‚",
              estimatedCost: "2,800 JPY",
              duration: "60",
              rating: 4.6,
              tips: "åç‰©ã®ãƒªã‚³ãƒƒã‚¿ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ï¼ˆ1,400å††ï¼‰ã¯çµ¶å¯¾æ³¨æ–‡ï¼å¹³æ—¥ãƒ©ãƒ³ãƒã¯æ¯”è¼ƒçš„ç©ºã„ã¦ã„ã¾ã™ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ãŒãµã‚ãµã‚ã§æ„Ÿå‹•ï¼ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®å‘³ã‚’æ±äº¬ã§æ¥½ã—ã‚ã¾ã—ãŸã€‚",
                  author: "ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­æ„›å¥½å®¶"
                }
              ]
            },
            {
              id: "act_7_transport",
              time: "14:15",
              name: "è¡¨å‚é“ â†’ è¡¨å‚é“ãƒ’ãƒ«ã‚º",
              location: "å¾’æ­©ç§»å‹•",
              coordinates: { lat: 35.6657, lng: 139.7085 },
              type: "transport",
              description: "è¡¨å‚é“é§…ã‹ã‚‰è¡¨å‚é“ãƒ’ãƒ«ã‚ºã¾ã§å¾’æ­©2åˆ†ã®çŸ­è·é›¢ç§»å‹•",
              estimatedCost: "0 JPY",
              duration: "2",
              rating: 4.0,
              tips: "è¡¨å‚é“ã®ç¾ã—ã„ã‚±ãƒ¤ã‚­ä¸¦æœ¨ã‚’æ¥½ã—ã¿ãªãŒã‚‰æ­©ã‘ã¾ã™ã€‚",
              transportDetails: {
                method: "å¾’æ­©",
                distance: "150m",
                walkingTime: "2åˆ†"
              }
            },
            {
              id: "act_8",
              time: "14:00",
              name: "è¡¨å‚é“ãƒ’ãƒ«ã‚º",
              location: "è¡¨å‚é“",
              coordinates: { lat: 35.6657, lng: 139.7085 },
              type: "shopping",
              description: "å»ºç¯‰å®¶ãƒ»å®‰è—¤å¿ é›„è¨­è¨ˆã®èºæ—‹ã‚¹ãƒ­ãƒ¼ãƒ—ãŒç¾ã—ã„ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°æ–½è¨­ã€‚åœ°ä¸‹3éšã€œåœ°ä¸Š3éšã«ç´„100åº—èˆ—ã€‚åŒæ½¤ä¼šé’å±±ã‚¢ãƒ‘ãƒ¼ãƒˆã®æ­´å²ã‚’å—ã‘ç¶™ãæ–‡åŒ–çš„å»ºç¯‰ç‰©ã€‚",
              estimatedCost: "6,000 JPY",
              duration: "120", 
              rating: 4.6,
              tips: "èºæ—‹ã‚¹ãƒ­ãƒ¼ãƒ—ã¯å»ºç¯‰ç¾ã®å‚‘ä½œï¼å±‹ä¸Šãƒ†ãƒ©ã‚¹ã€Œã‚¹ãƒšãƒ¼ã‚¹ ã‚ªãƒ¼ã€ã‹ã‚‰ã®è¡¨å‚é“ã‚±ãƒ¤ã‚­ä¸¦æœ¨ã®çœºã‚ã¯çµ¶æ™¯ã§ã™ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "å®‰è—¤å¿ é›„ã®å»ºç¯‰ç¾ã«æ„Ÿå‹•ï¼ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã—ãªãŒã‚‰èŠ¸è¡“ä½œå“ã®ä¸­ã‚’æ­©ã„ã¦ã„ã‚‹æ°—åˆ†ã€‚",
                  author: "å»ºç¯‰æ„›å¥½å®¶"
                }
              ]
            },
            {
              id: "act_8_transport",
              time: "16:45",
              name: "è¡¨å‚é“ â†’ æ¸‹è°·",
              location: "JRå±±æ‰‹ç·š",
              coordinates: { lat: 35.6581, lng: 139.7016 },
              type: "transport",
              description: "JRå±±æ‰‹ç·šã§è¡¨å‚é“ã‹ã‚‰æ¸‹è°·ã¾ã§ç´„7åˆ†ã®é›»è»Šç§»å‹•",
              estimatedCost: "160 JPY",
              duration: "7",
              rating: 4.3,
              tips: "å±±æ‰‹ç·šã¯2-4åˆ†é–“éš”ã§é‹è¡Œã€‚ãƒ©ãƒƒã‚·ãƒ¥æ™‚é–“ã‚’é¿ã‘ã¦ã„ã‚‹ã®ã§æ¯”è¼ƒçš„ç©ºã„ã¦ã„ã¾ã™ã€‚",
              transportDetails: {
                method: "é›»è»Š",
                line: "JRå±±æ‰‹ç·š",
                transfers: 0,
                walkingTime: "3åˆ†"
              }
            },
            {
              id: "act_9",
              time: "16:30", 
              name: "æ¸‹è°·ã‚¹ã‚«ã‚¤å±•æœ›å°",
              location: "æ¸‹è°·",
              coordinates: { lat: 35.6581, lng: 139.7016 },
              type: "sightseeing",
              description: "æ¸‹è°·ã‚¹ã‚«ã‚¤ãƒ“ãƒ«å±‹ä¸Šã®360åº¦ãƒ‘ãƒãƒ©ãƒå±•æœ›å°ï¼ˆåœ°ä¸Š230mï¼‰ã€‚ä¸–ç•Œæœ€å¤§ç´šã®ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹ã‚’ä¸Šã‹ã‚‰è¦‹ä¸‹ã‚ã—ã€æ™´å¤©æ™‚ã¯å¯Œå£«å±±ã€æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ã¾ã§ä¸€æœ›ã€‚",
              estimatedCost: "2000 JPY",
              duration: "60",
              rating: 4.7,
              tips: "å¤•æ—¥ã‚¿ã‚¤ãƒ ï¼ˆ17:00-18:30ï¼‰ãŒãƒ™ã‚¹ãƒˆï¼ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹ã®äººã®æµã‚Œã¯åœ§å·»ã€‚å†™çœŸæ’®å½±ã‚¹ãƒãƒƒãƒˆå¤šæ•°ã€‚",
              reviews: [
                {
                  rating: 5,
                  text: "ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹ã‚’ä¸Šã‹ã‚‰è¦‹ã‚‹ä½“é¨“ã¯å”¯ä¸€ç„¡äºŒï¼å¤•æ—¥ã¨æ±äº¬ã®å¤œæ™¯ãŒæœ€é«˜ã§ã—ãŸã€‚",
                  author: "çµ¶æ™¯ãƒãƒ³ã‚¿ãƒ¼"
                }
              ]
            },
            {
              id: "act_9_dinner",
              time: "19:00",
              name: "æ¸‹è°·ã€Œé³¥è²´æ—ã€ï¼ˆå¤•é£Ÿï¼‰",
              location: "æ¸‹è°·",
              coordinates: { lat: 35.6598, lng: 139.7006 },
              type: "food",
              description: "å…¨å“298å††ï¼ˆç¨æŠœï¼‰ã®ç„¼ãé³¥å±…é…’å±‹ãƒã‚§ãƒ¼ãƒ³ã€‚æ–°é®®ãªå›½ç”£é¶ã‚’ä½¿ã£ãŸç„¼ãé³¥ã¨è±Šå¯Œãªãƒ‰ãƒªãƒ³ã‚¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ã€æ—¥æœ¬ã®å±…é…’å±‹æ–‡åŒ–ã‚’æ°—è»½ã«ä½“é¨“ã§ãã¾ã™ã€‚",
              estimatedCost: "2,500 JPY",
              duration: "90",
              rating: 4.4,
              tips: "ã€Œã‚‚ã‚‚è²´æ—ç„¼ã€ã¨ã€Œã¤ãã­ã€ã¯å®šç•ªï¼ä¹¾æ¯ã¯ã€Œã‚«ãƒ³ãƒ‘ã‚¤ï¼ã€ã§ã€‚ãƒã‚¤ãƒœãƒ¼ãƒ«ãŒäººæ°—ã§ã™ã€‚",
              reviews: [
                {
                  rating: 4,
                  text: "ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«ã§ç¾å‘³ã—ã„ï¼åœ°å…ƒã®äººãŸã¡ã¨ä¸€ç·’ã«æ¥½ã—ã„æ™‚é–“ã‚’éã”ã›ã¾ã—ãŸã€‚",
                  author: "å±…é…’å±‹æ¢æ¤œå®¶"
                }
              ]
            }
          ]
        }
      ]
    },
    isMockData: true,
    message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
  };
};

// TripAdvisor Mock Data
export const mockTripAdvisorResponse = (): MockDataResponse => ({
  success: true,
  data: [
    {
      name: "æµ…è‰å¯º",
      description: "645å¹´å‰µå»ºã®æ±äº¬æœ€å¤ã®å¯ºé™¢ã€‚é›·é–€ã€ä»²è¦‹ä¸–é€šã‚Šã€æœ¬å ‚ãªã©è¦‹ã©ã“ã‚æº€è¼‰ã€‚å¹´é–“ç´„3000ä¸‡äººãŒè¨ªã‚Œã‚‹æ±äº¬å±ˆæŒ‡ã®è¦³å…‰åæ‰€ã§ã™ã€‚",
      rating: "4.5",
      num_reviews: "15,000+",
      photo: {
        images: {
          original: {
            url: "https://images.pexels.com/photos/161251/senso-ji-temple-asakusa-tokyo-japan-161251.jpeg"
          }
        }
      },
      web_url: "https://www.tripadvisor.com/Attraction_Review-g1066451-d320046-Reviews-Senso_ji_Temple-Taito_Tokyo_Tokyo_Prefecture_Kanto.html"
    },
    {
      name: "æ˜æ²»ç¥å®®",
      description: "æ˜æ²»å¤©çš‡ã¨æ˜­æ†²çš‡å¤ªåã‚’ç¥€ã‚‹ç¥ç¤¾ã€‚éƒ½å¿ƒã«ã‚ã‚ŠãªãŒã‚‰70ä¸‡å¹³æ–¹ãƒ¡ãƒ¼ãƒˆãƒ«ã®æ·±ã„æ£®ã«å›²ã¾ã‚ŒãŸç¥è–ãªç©ºé–“ã§ã™ã€‚",
      rating: "4.9",
      num_reviews: "12,000+",
      photo: {
        images: {
          original: {
            url: "https://images.pexels.com/photos/2070033/pexels-photo-2070033.jpeg"
          }
        }
      },
      web_url: "https://www.tripadvisor.com/Attraction_Review-g1066456-d320047-Reviews-Meiji_Shrine-Shibuya_Tokyo_Tokyo_Prefecture_Kanto.html"
    }
  ],
  reviews: {
    data: [
      {
        title: "æ—©æœå‚æ‹ãŒæœ€é«˜ã§ã—ãŸ",
        text: "æœ6æ™‚ã«è¨ªã‚Œã¾ã—ãŸãŒã€è¦³å…‰å®¢ã‚‚å°‘ãªãé™å¯‚ãªé›°å›²æ°—ã®ä¸­ã§å‚æ‹ã§ãã¾ã—ãŸã€‚é›·é–€ã‹ã‚‰æœ¬å ‚ã¾ã§ã®é“ã®ã‚Šã§æ—¥æœ¬ã®æ­´å²ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚",
        rating: 5,
        user: { username: "TokyoMorningWalker" }
      },
      {
        title: "ä»²è¦‹ä¸–é€šã‚Šã®ã‚°ãƒ«ãƒ¡ãŒæœ€é«˜",
        text: "äººå½¢ç„¼ãã¨é›·ãŠã“ã—ã‚’é£Ÿã¹æ­©ãã—ã¾ã—ãŸã€‚ã©ã¡ã‚‰ã‚‚å‡ºæ¥ç«‹ã¦ã§ç¾å‘³ã—ãã€ãŠåœŸç”£ã«ã‚‚æœ€é©ã§ã™ã€‚å¤–å›½äººè¦³å…‰å®¢ã«ã‚‚å„ªã—ã„ãŠåº—ãŒå¤šã„ã§ã™ã€‚",
        rating: 4,
        user: { username: "FoodieExplorer" }
      },
      {
        title: "å¤œã®ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã‚‚ç¾ã—ã„",
        text: "æ˜¼é–“ã¨ã¯é•ã£ãŸå¹»æƒ³çš„ãªé›°å›²æ°—ã‚’æ¥½ã—ã‚ã¾ã™ã€‚äº”é‡å¡”ã®ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ã¯ç‰¹ã«å°è±¡çš„ã§ã—ãŸã€‚",
        rating: 5,
        user: { username: "NightPhotographer" }
      }
    ]
  },
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
});

// Google Maps Mock Data
export const mockGoogleMapsResponse = (): MockDataResponse => ({
  success: true,
  data: [
    {
      id: "place_1",
      name: "æµ…è‰å¯º",
      nameEn: "Senso-ji Temple",
      category: "temple",
      rating: 4.8,
      distance: "0.5km",
      address: "æ±äº¬éƒ½å°æ±åŒºæµ…è‰2-3-1",
      phone: "03-3842-0181",
      hours: "6:00-17:00",
      description: "æ±äº¬æœ€å¤ã®å¯ºé™¢",
      image: "https://images.pexels.com/photos/161251/senso-ji-temple-asakusa-tokyo-japan-161251.jpeg"
    },
    {
      id: "place_2",
      name: "æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼",
      nameEn: "Tokyo Skytree", 
      category: "landmark",
      rating: 4.7,
      distance: "1.2km",
      address: "æ±äº¬éƒ½å¢¨ç”°åŒºæŠ¼ä¸Š1-1-2",
      phone: "0570-55-0634",
      hours: "8:00-22:00",
      description: "ä¸–ç•Œä¸€é«˜ã„é›»æ³¢å¡”",
      image: "https://images.pexels.com/photos/2070033/pexels-photo-2070033.jpeg"
    }
  ],
  predictions: [
    {
      structured_formatting: { main_text: "æµ…è‰å¯º" },
      description: "æ±äº¬éƒ½å°æ±åŒºæµ…è‰2-3-1, æ—¥æœ¬",
      place_id: "mock_asakusa_temple",
      types: ["place_of_worship", "tourist_attraction"]
    },
    {
      structured_formatting: { main_text: "æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼" },
      description: "æ±äº¬éƒ½å¢¨ç”°åŒºæŠ¼ä¸Š1-1-2, æ—¥æœ¬", 
      place_id: "mock_tokyo_skytree",
      types: ["tourist_attraction", "point_of_interest"]
    }
  ],
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
});

// eSIM Mock Data
export const mockESIMResponse = (): MockDataResponse => ({
  success: true,
  data: [
    {
      id: "esim_plan_1",
      name: "Japan 3GB - 15 Days",
      description: "æ—¥æœ¬å…¨å›½ã§ä½¿ãˆã‚‹15æ—¥é–“3GBãƒ—ãƒ©ãƒ³",
      dataAmount: "3GB",
      validity: "15æ—¥",
      price: { amount: 3500, currency: "JPY" },
      coverage: "æ—¥æœ¬å…¨å›½",
      network: "NTT Docomo"
    },
    {
      id: "esim_plan_2", 
      name: "Japan 10GB - 30 Days",
      description: "æ—¥æœ¬å…¨å›½ã§ä½¿ãˆã‚‹30æ—¥é–“10GBãƒ—ãƒ©ãƒ³",
      dataAmount: "10GB",
      validity: "30æ—¥",
      price: { amount: 8500, currency: "JPY" },
      coverage: "æ—¥æœ¬å…¨å›½",
      network: "NTT Docomo"
    },
    {
      id: "esim_plan_3",
      name: "Japan 1GB - 7 Days", 
      description: "çŸ­æœŸæ»åœ¨å‘ã‘7æ—¥é–“1GBãƒ—ãƒ©ãƒ³",
      dataAmount: "1GB",
      validity: "7æ—¥",
      price: { amount: 1500, currency: "JPY" },
      coverage: "æ—¥æœ¬å…¨å›½",
      network: "SoftBank"
    }
  ],
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
});

// Amadeus Mock Data
export const mockAmadeusResponse = (): MockDataResponse => ({
  success: true,
  data: {
    flights: [
      {
        id: "flight_1",
        airline: "JAL",
        flightNumber: "JL123",
        departure: {
          airport: "NRT",
          city: "Tokyo",
          time: "09:30"
        },
        arrival: {
          airport: "KIX", 
          city: "Osaka",
          time: "11:00"
        },
        price: { amount: 15000, currency: "JPY" },
        duration: "1h 30m"
      }
    ],
    hotels: [
      {
        id: "hotel_1",
        name: "ã‚°ãƒ©ãƒ³ãƒ‰ãƒ›ãƒ†ãƒ«æ±äº¬",
        location: "æ±äº¬é§…å‘¨è¾º",
        rating: 4.5,
        price: { amount: 25000, currency: "JPY" },
        amenities: ["WiFi", "æœé£Ÿ", "æ¸©æ³‰", "ã‚¸ãƒ "]
      }
    ]
  },
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
});

// Currency Convert Mock Data
export const mockCurrencyResponse = (): MockDataResponse => ({
  success: true,
  data: {
    rates: {
      "USD": 0.0067,
      "EUR": 0.0063,
      "GBP": 0.0054,
      "CNY": 0.048,
      "KRW": 9.2,
      "THB": 0.23
    },
    base: "JPY",
    date: new Date().toISOString().split('T')[0]
  },
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
});

// Stripe Mock Data
export const mockStripeResponse = (): MockDataResponse => ({
  success: true,
  data: {
    sessionUrl: "#mock-checkout-session",
    sessionId: "mock_session_123"
  },
  isMockData: true,
  message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚æ±ºæ¸ˆæ©Ÿèƒ½ã¯ç¾åœ¨åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚"
});

// Get mock data by endpoint
export const getMockDataByEndpoint = (endpoint: string): MockDataResponse => {
  switch (endpoint) {
    case '/openai-chat':
      return mockChatResponse();
    case '/openai-vision':
      return mockVisionResponse();
    case '/openai-generate':
      return mockGenerateResponse();
    case '/tripadvisor':
      return mockTripAdvisorResponse();
    case '/google-maps':
    case '/google-places':
      return mockGoogleMapsResponse();
    case '/esim':
      return mockESIMResponse();
    case '/amadeus':
      return mockAmadeusResponse();
    case '/currency-convert':
      return mockCurrencyResponse();
    case '/create-checkout-session':
    case '/verify-payment':
      return mockStripeResponse();
    default:
      return {
        success: false,
        data: null,
        isMockData: true,
        message: "é€šä¿¡ã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚"
      };
  }
};
</file>

<file path="src/components/questionnaire/Confirmation.tsx">
import React, { useState, useEffect } from 'react';
import { motion } from 'framer-motion';
import { useNavigate } from 'react-router-dom';
import { CheckCircle, ArrowRight, ArrowLeft, Edit, Sparkles, Calendar, MapPin, Users, DollarSign, Clock, Settings, Smartphone } from 'lucide-react';
import { useLanguage } from '../../contexts/LanguageContext';

const Confirmation: React.FC = () => {
  const navigate = useNavigate();
  const { t } = useLanguage();
  const [formData, setFormData] = useState<any>({});
  const [isGenerating, setIsGenerating] = useState(false);

  // Define all possible interests and dietary restrictions with icons
  const allInterests = [
    { id: 'history-culture', icon: 'ğŸ¯', category: 'culture', name: 'æ­´å²ãƒ»æ–‡åŒ–' },
    { id: 'temples-shrines', icon: 'â›©ï¸', category: 'culture', name: 'å¯ºé™¢ãƒ»ç¥ç¤¾' },
    { id: 'traditional-experience', icon: 'ğŸ', category: 'culture', name: 'ä¼çµ±ä½“é¨“' },
    { id: 'castles-historic-sites', icon: 'ğŸ°', category: 'culture', name: 'åŸãƒ»å²è·¡' },
    { id: 'museums-galleries', icon: 'ğŸ“š', category: 'culture', name: 'åšç‰©é¤¨ãƒ»ç¾è¡“é¤¨' },
    { id: 'nature-scenery', icon: 'ğŸŒ¸', category: 'nature', name: 'è‡ªç„¶ãƒ»æ™¯è‰²' },
    { id: 'hiking-trekking', icon: 'ğŸ¥¾', category: 'nature', name: 'ãƒã‚¤ã‚­ãƒ³ã‚°' },
    { id: 'beach-swimming', icon: 'ğŸ–ï¸', category: 'nature', name: 'ãƒ“ãƒ¼ãƒãƒ»æµ·æ°´æµ´' },
    { id: 'forest-mountain-camping', icon: 'ğŸŒ²', category: 'nature', name: 'æ£®æ—ãƒ»å±±å²³ã‚­ãƒ£ãƒ³ãƒ—' },
    { id: 'national-parks', icon: 'ğŸï¸', category: 'nature', name: 'å›½ç«‹å…¬åœ’' },
    { id: 'cycling', icon: 'ğŸš´', category: 'nature', name: 'ã‚µã‚¤ã‚¯ãƒªãƒ³ã‚°' },
    { id: 'anime-manga', icon: 'ğŸŒ', category: 'entertainment', name: 'ã‚¢ãƒ‹ãƒ¡ãƒ»ãƒãƒ³ã‚¬' },
    { id: 'nightlife', icon: 'ğŸŒƒ', category: 'entertainment', name: 'ãƒŠã‚¤ãƒˆãƒ©ã‚¤ãƒ•' },
    { id: 'shopping', icon: 'ğŸ›ï¸', category: 'entertainment', name: 'ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°' },
    { id: 'urban-architecture', icon: 'ğŸ™ï¸', category: 'entertainment', name: 'éƒ½å¸‚å»ºç¯‰' },
    { id: 'cafe-bar-hopping', icon: 'ğŸ¹', category: 'entertainment', name: 'ã‚«ãƒ•ã‚§ãƒ»ãƒãƒ¼å·¡ã‚Š' },
    { id: 'food-gourmet', icon: 'ğŸœ', category: 'food', name: 'ã‚°ãƒ«ãƒ¡' },
    { id: 'local-street-food', icon: 'ğŸ£', category: 'food', name: 'åœ°å…ƒã‚°ãƒ«ãƒ¡' },
    { id: 'wine-sake-tasting', icon: 'ğŸ·', category: 'food', name: 'ãŠé…’ã®è©¦é£²' },
    { id: 'sweets-cafe', icon: 'ğŸ«', category: 'food', name: 'ã‚¹ã‚¤ãƒ¼ãƒ„ãƒ»ã‚«ãƒ•ã‚§' },
    { id: 'festivals-events', icon: 'ğŸ†', category: 'events', name: 'ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«' },
    { id: 'gaming-esports', icon: 'ğŸ®', category: 'events', name: 'ã‚²ãƒ¼ãƒ ãƒ»eã‚¹ãƒãƒ¼ãƒ„' },
    { id: 'performance-live', icon: 'ğŸ¤¹â€â™‚ï¸', category: 'events', name: 'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹' },
    { id: 'theater-musical', icon: 'ğŸ­', category: 'events', name: 'æ¼”åŠ‡ãƒ»ãƒŸãƒ¥ãƒ¼ã‚¸ã‚«ãƒ«' },
    { id: 'hot-springs', icon: 'â™¨ï¸', category: 'wellness', name: 'æ¸©æ³‰' },
    { id: 'massage-spa', icon: 'ğŸ’†â€â™‚ï¸', category: 'wellness', name: 'ãƒãƒƒã‚µãƒ¼ã‚¸ãƒ»ã‚¹ãƒ‘' },
    { id: 'fitness-activities', icon: 'ğŸ‹ï¸â€â™‚ï¸', category: 'wellness', name: 'ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹' },
    { id: 'yoga-meditation', icon: 'ğŸ§˜â€â™€ï¸', category: 'wellness', name: 'ãƒ¨ã‚¬ãƒ»ç‘æƒ³' },
    { id: 'technology', icon: 'ğŸ¤–', category: 'tech', name: 'ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼' },
    { id: 'vr-ar-experience', icon: 'ğŸ›¸', category: 'tech', name: 'VRãƒ»ARä½“é¨“' },
    { id: 'science-tech-facilities', icon: 'ğŸš€', category: 'tech', name: 'ç§‘å­¦æŠ€è¡“æ–½è¨­' },
    { id: 'fashion', icon: 'ğŸ‘˜', category: 'fashion', name: 'ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³' },
    { id: 'brand-outlet', icon: 'ğŸ‘œ', category: 'fashion', name: 'ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ»ã‚¢ã‚¦ãƒˆãƒ¬ãƒƒãƒˆ' },
    { id: 'online-shopping', icon: 'ğŸ›’', category: 'fashion', name: 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°' },
    { id: 'halal', icon: 'ğŸ•‹', category: 'dietary', name: 'ãƒãƒ©ãƒ«' },
    { id: 'vegetarian', icon: 'ğŸŒ±', category: 'dietary', name: 'ãƒ™ã‚¸ã‚¿ãƒªã‚¢ãƒ³' },
    { id: 'vegan', icon: 'ğŸ¥¬', category: 'dietary', name: 'ãƒ“ãƒ¼ã‚¬ãƒ³' },
    { id: 'dairy-free', icon: 'ğŸ¥›', category: 'dietary', name: 'ä¹³è£½å“ä¸ä½¿ç”¨' },
    { id: 'egg-free', icon: 'ğŸ³', category: 'dietary', name: 'åµä¸ä½¿ç”¨' },
    { id: 'gluten-free', icon: 'ğŸŒ¾', category: 'dietary', name: 'ã‚°ãƒ«ãƒ†ãƒ³ãƒ•ãƒªãƒ¼' },
    { id: 'no-seafood', icon: 'ğŸŸ', category: 'dietary', name: 'é­šä»‹é¡ãªã—' },
    { id: 'meat-restrictions', icon: 'ğŸ¥©', category: 'dietary', name: 'è‚‰é¡åˆ¶é™' },
    { id: 'mild-spice', icon: 'ğŸŒ¶ï¸', category: 'dietary', name: 'è¾›ã•æ§ãˆã‚' },
    { id: 'allergy-friendly', icon: 'ğŸ«', category: 'dietary', name: 'ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œ' },
    { id: 'organic-preference', icon: 'ğŸƒ', category: 'dietary', name: 'ã‚ªãƒ¼ã‚¬ãƒ‹ãƒƒã‚¯å¥½ã¿' }
  ];

  const transportationOptions = [
    { id: 'shinkansen', name: 'æ–°å¹¹ç·š', icon: 'ğŸš„' },
    { id: 'local-train', name: 'åœ¨æ¥ç·š', icon: 'ğŸšƒ' },
    { id: 'bus', name: 'ãƒã‚¹', icon: 'ğŸšŒ' },
    { id: 'rental-car', name: 'ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼', icon: 'ğŸš—' },
    { id: 'taxi', name: 'ã‚¿ã‚¯ã‚·ãƒ¼', icon: 'ğŸš•' },
    { id: 'bicycle', name: 'è‡ªè»¢è»Š', icon: 'ğŸš²' },
    { id: 'ferry', name: 'ãƒ•ã‚§ãƒªãƒ¼', icon: 'â›´ï¸' },
    { id: 'airplane', name: 'é£›è¡Œæ©Ÿ', icon: 'âœˆï¸' }
  ];

  const accommodationOptions = [
    { id: 'hotel', name: 'ãƒ›ãƒ†ãƒ«', icon: 'ğŸ¨' },
    { id: 'ryokan', name: 'æ—…é¤¨', icon: 'ğŸ¯' },
    { id: 'hostel', name: 'ãƒ›ã‚¹ãƒ†ãƒ«', icon: 'ğŸ ' },
    { id: 'airbnb', name: 'Airbnb', icon: 'ğŸ¡' },
    { id: 'capsule', name: 'ã‚«ãƒ—ã‚»ãƒ«ãƒ›ãƒ†ãƒ«', icon: 'ğŸ›ï¸' },
    { id: 'minshuku', name: 'æ°‘å®¿', icon: 'ğŸ˜ï¸' },
    { id: 'luxury-resort', name: 'é«˜ç´šãƒªã‚¾ãƒ¼ãƒˆ', icon: 'ğŸ–ï¸' },
    { id: 'camping', name: 'ã‚­ãƒ£ãƒ³ãƒ—', icon: 'â›º' },
    { id: 'unnecessary', name: 'å¿…è¦ãªã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³', icon: 'âŒ' }
  ];

  useEffect(() => {
    console.log('ğŸ¯ Confirmation component mounted!');
    console.log('ğŸ“ Current URL:', window.location.pathname);
    
    // Load all form data from localStorage
    const basicInfo = JSON.parse(localStorage.getItem('trippin-basic-info') || '{}');
    const travelStyle = JSON.parse(localStorage.getItem('trippin-travel-style') || '{}');
    const detailedPreferences = localStorage.getItem('trippin-detailed-preferences');
    
    console.log('ğŸ“Š localStorage check:');
    console.log('- basicInfo:', basicInfo);
    console.log('- travelStyle:', travelStyle);
    console.log('- detailedPreferences:', detailedPreferences);
    
    // If detailed preferences don't exist, redirect to details page
    if (!detailedPreferences) {
      console.log('âŒ No detailed preferences found, redirecting to details page');
      navigate('/questionnaire/details');
      return;
    }
    
    console.log('âœ… All data found, loading confirmation page');
    const parsedDetailedPreferences = JSON.parse(detailedPreferences);
    
    setFormData({
      basicInfo,
      travelStyle,
      detailedPreferences: parsedDetailedPreferences
    });
  }, [navigate]);

  // Prepare data for OpenAI
  const prepareDataForOpenAI = () => {
    const selectedInterests = formData.travelStyle?.interests || [];
    const selectedTransportation = formData.detailedPreferences?.transportation || [];
    const selectedAccommodation = formData.detailedPreferences?.accommodation || [];
    
    // Get interest details with names and categories
    const interestDetails = selectedInterests.map((interestId: string) => {
      const interest = allInterests.find(i => i.id === interestId);
      return interest ? { id: interestId, name: interest.name, category: interest.category, icon: interest.icon } : null;
    }).filter(Boolean);

    // Get transportation details
    const transportationDetails = selectedTransportation.map((transportId: string) => {
      const transport = transportationOptions.find(t => t.id === transportId);
      return transport ? { id: transportId, name: transport.name, icon: transport.icon } : null;
    }).filter(Boolean);

    // Get accommodation details
    const accommodationDetails = selectedAccommodation.map((accommodationId: string) => {
      const accommodation = accommodationOptions.find(a => a.id === accommodationId);
      return accommodation ? { id: accommodationId, name: accommodation.name, icon: accommodation.icon } : null;
    }).filter(Boolean);

    const openAIData = {
      trip: {
        title: formData.basicInfo?.tripTitle || 'æ—¥æœ¬æ—…è¡Œ',
        destination: formData.basicInfo?.destination,
        startDate: formData.basicInfo?.startDate,
        endDate: formData.basicInfo?.endDate,
        travelers: formData.basicInfo?.travelers,
        budget: {
          amount: formData.travelStyle?.budget,
          currency: formData.travelStyle?.currency
        }
      },
      preferences: {
        interests: interestDetails,
        transportation: transportationDetails,
        accommodation: accommodationDetails,
        esim: formData.detailedPreferences?.esim || false
      },
      categories: {
        culture: interestDetails.filter((i: any) => i.category === 'culture'),
        nature: interestDetails.filter((i: any) => i.category === 'nature'),
        entertainment: interestDetails.filter((i: any) => i.category === 'entertainment'),
        food: interestDetails.filter((i: any) => i.category === 'food'),
        events: interestDetails.filter((i: any) => i.category === 'events'),
        wellness: interestDetails.filter((i: any) => i.category === 'wellness'),
        tech: interestDetails.filter((i: any) => i.category === 'tech'),
        fashion: interestDetails.filter((i: any) => i.category === 'fashion'),
        dietary: interestDetails.filter((i: any) => i.category === 'dietary')
      }
    };

    return openAIData;
  };

  const handleGeneratePlan = async () => {
    setIsGenerating(true);
    
    // Prepare complete data for OpenAI
    const openAIData = prepareDataForOpenAI();
    
    console.log('ğŸš€ Sending to OpenAI:', openAIData);
    
    // Save complete data
    localStorage.setItem('trippin-complete-data', JSON.stringify(openAIData));
    
    // Simulate API call delay
    setTimeout(() => {
      setIsGenerating(false);
      navigate('/plan-generation');
    }, 2000);
  };

  const handleBack = () => {
    navigate('/questionnaire/details');
  };

  const formatDate = (dateString: string) => {
    if (!dateString) return '';
    const date = new Date(dateString);
    return date.toLocaleDateString('ja-JP', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  };

  const getDuration = () => {
    if (!formData.basicInfo?.startDate || !formData.basicInfo?.endDate) return '';
    const start = new Date(formData.basicInfo.startDate);
    const end = new Date(formData.basicInfo.endDate);
    const diffTime = Math.abs(end.getTime() - start.getTime());
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    return `${diffDays}æ—¥é–“`;
  };

  const getSelectedTransportation = () => {
    const selectedTransportation = formData.detailedPreferences?.transportation || [];
    return transportationOptions.filter(transport => 
      selectedTransportation.includes(transport.id)
    );
  };

  const getSelectedAccommodation = () => {
    const selectedAccommodation = formData.detailedPreferences?.accommodation || [];
    return accommodationOptions.filter(accommodation => 
      selectedAccommodation.includes(accommodation.id)
    );
  };

  // Animation variants
  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.1
      }
    }
  };

  const itemVariants = {
    hidden: { y: 20, opacity: 0 },
    visible: {
      y: 0,
      opacity: 1,
      transition: {
        type: "spring",
        damping: 12,
        stiffness: 200
      }
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center p-6 bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 relative overflow-hidden">
      {/* Animated background elements */}
      <div className="absolute inset-0 overflow-hidden">
        <motion.div
          className="absolute top-10 left-10 w-72 h-72 bg-gradient-to-r from-green-300 to-emerald-300 rounded-full opacity-20 blur-3xl"
          animate={{
            x: [0, 100, 0],
            y: [0, -50, 0],
          }}
          transition={{
            duration: 20,
            repeat: Infinity,
            ease: "easeInOut"
          }}
        />
        <motion.div
          className="absolute top-1/2 right-10 w-96 h-96 bg-gradient-to-r from-teal-300 to-cyan-300 rounded-full opacity-15 blur-3xl"
          animate={{
            x: [0, -80, 0],
            y: [0, 60, 0],
          }}
          transition={{
            duration: 25,
            repeat: Infinity,
            ease: "easeInOut"
          }}
        />
      </div>

      <motion.div
        className="max-w-6xl w-full relative z-10"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.8 }}
      >
        {/* Header */}
        <div className="text-center mb-8">
          <motion.div
            className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full mb-6 relative shadow-xl"
            initial={{ scale: 0, rotate: -180 }}
            animate={{ scale: 1, rotate: 0 }}
            transition={{ 
              type: "spring",
              damping: 10,
              stiffness: 200,
              delay: 0.2 
            }}
            whileHover={{ 
              scale: 1.1,
              boxShadow: "0 20px 40px rgba(16, 185, 129, 0.3)"
            }}
          >
            <CheckCircle className="w-8 h-8 text-white" />
            <motion.div
              className="absolute -top-2 -right-2 w-6 h-6 bg-yellow-400 rounded-full flex items-center justify-center"
              animate={{ 
                rotate: [0, 360],
                scale: [1, 1.2, 1]
              }}
              transition={{
                duration: 3,
                repeat: Infinity,
                ease: "easeInOut"
              }}
            >
              <Sparkles className="w-3 h-3 text-white" />
            </motion.div>
          </motion.div>
          
          <motion.h1
            className="text-3xl md:text-4xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent mb-4"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.8, delay: 0.3 }}
          >
            æ—…è¡Œãƒ—ãƒ©ãƒ³ç¢ºèª
          </motion.h1>
          
          <motion.p
            className="text-lg text-gray-600"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.8, delay: 0.4 }}
          >
            ã‚ãªãŸã®ç†æƒ³ã®æ—…è¡Œãƒ—ãƒ©ãƒ³ã‚’ç”Ÿæˆã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸ
          </motion.p>
        </div>

        <motion.div
          className="bg-white/80 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20 space-y-8"
          initial={{ opacity: 0, y: 30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8, delay: 0.5 }}
        >
          {/* Trip Overview */}
          <div className="bg-gradient-to-r from-blue-50 to-emerald-50 rounded-2xl p-6">
            <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-3">
              <Calendar className="w-6 h-6 text-emerald-600" />
              {formData.basicInfo?.tripTitle || 'æ—¥æœ¬æ—…è¡Œ'}
            </h2>
            <div className="grid md:grid-cols-2 gap-4 text-gray-700">
              <div className="flex items-center space-x-2">
                <MapPin className="w-4 h-4 text-gray-500" />
                <span className="font-medium">ç›®çš„åœ°:</span> {formData.basicInfo?.destination}
              </div>
              <div className="flex items-center space-x-2">
                <Clock className="w-4 h-4 text-gray-500" />
                <span className="font-medium">æœŸé–“:</span> {getDuration()}
              </div>
              <div className="flex items-center space-x-2">
                <Calendar className="w-4 h-4 text-gray-500" />
                <span className="font-medium">å‡ºç™ºæ—¥:</span> {formatDate(formData.basicInfo?.startDate)}
              </div>
              <div className="flex items-center space-x-2">
                <Calendar className="w-4 h-4 text-gray-500" />
                <span className="font-medium">å¸°å›½æ—¥:</span> {formatDate(formData.basicInfo?.endDate)}
              </div>
              <div className="flex items-center space-x-2">
                <Users className="w-4 h-4 text-gray-500" />
                <span className="font-medium">æ—…è¡Œè€…æ•°:</span> {formData.basicInfo?.travelers}äºº
              </div>
              <div className="flex items-center space-x-2">
                <DollarSign className="w-4 h-4 text-gray-500" />
                <span className="font-medium">äºˆç®—:</span> {formData.travelStyle?.budget} {formData.travelStyle?.currency}
              </div>
            </div>
          </div>

          {/* Selected Interests */}
          {formData.travelStyle?.interests?.length > 0 && (
            <motion.div 
              className="space-y-4"
              variants={containerVariants}
              initial="hidden"
              animate="visible"
            >
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-xl font-semibold text-gray-800 flex items-center gap-2">
                  <span className="text-2xl">â¤ï¸</span>
                  èˆˆå‘³ãƒ»é–¢å¿ƒäº‹é …
                </h3>
                <button
                  onClick={() => navigate('/questionnaire/style')}
                  className="text-emerald-600 hover:text-emerald-700 flex items-center space-x-1"
                >
                  <Edit className="w-4 h-4" />
                  <span>ç·¨é›†</span>
                </button>
              </div>
              <motion.div 
                className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"
                variants={containerVariants}
              >
                {formData.travelStyle.interests.map((interestId: string) => {
                  const interest = allInterests.find(i => i.id === interestId);
                  if (!interest) return null;
                  
                  return (
                    <motion.div
                      key={interest.id}
                      className="p-4 rounded-2xl border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-green-50 text-emerald-700 shadow-sm relative overflow-hidden group"
                      variants={itemVariants}
                      whileHover={{ 
                        scale: 1.05,
                        boxShadow: "0 10px 30px rgba(0,0,0,0.1)"
                      }}
                    >
                      <div className="text-3xl mb-2">{interest.icon}</div>
                      <div className="text-sm font-medium">{interest.name}</div>
                      <div className="absolute top-2 right-2 w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center">
                        <div className="w-3 h-3 bg-white rounded-full" />
                      </div>
                    </motion.div>
                  );
                })}
              </motion.div>
            </motion.div>
          )}

          {/* Transportation */}
          {getSelectedTransportation().length > 0 && (
            <motion.div 
              className="space-y-4"
              variants={containerVariants}
              initial="hidden"
              animate="visible"
            >
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-xl font-semibold text-gray-800 flex items-center gap-2">
                  <Settings className="w-6 h-6 text-purple-600" />
                  äº¤é€šæ‰‹æ®µ
                </h3>
                <button
                  onClick={() => navigate('/questionnaire/details')}
                  className="text-purple-600 hover:text-purple-700 flex items-center space-x-1"
                >
                  <Edit className="w-4 h-4" />
                  <span>ç·¨é›†</span>
                </button>
              </div>
              <motion.div 
                className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"
                variants={containerVariants}
              >
                {getSelectedTransportation().map((transport) => (
                  <motion.div
                    key={transport.id}
                    className="p-4 rounded-2xl border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100 text-purple-700 shadow-sm relative overflow-hidden group"
                    variants={itemVariants}
                    whileHover={{ 
                      scale: 1.05,
                      boxShadow: "0 10px 30px rgba(0,0,0,0.1)"
                    }}
                  >
                    <div className="text-3xl mb-2">{transport.icon}</div>
                    <div className="text-sm font-medium">{transport.name}</div>
                    <div className="absolute top-2 right-2 w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center">
                      <div className="w-3 h-3 bg-white rounded-full" />
                    </div>
                  </motion.div>
                ))}
              </motion.div>
            </motion.div>
          )}

          {/* Accommodation */}
          {getSelectedAccommodation().length > 0 && (
            <motion.div 
              className="space-y-4"
              variants={containerVariants}
              initial="hidden"
              animate="visible"
            >
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-xl font-semibold text-gray-800 flex items-center gap-2">
                  <span className="text-2xl">ğŸ¨</span>
                  å®¿æ³Šæ–½è¨­
                </h3>
                <button
                  onClick={() => navigate('/questionnaire/details')}
                  className="text-blue-600 hover:text-blue-700 flex items-center space-x-1"
                >
                  <Edit className="w-4 h-4" />
                  <span>ç·¨é›†</span>
                </button>
              </div>
              <motion.div 
                className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"
                variants={containerVariants}
              >
                {getSelectedAccommodation().map((accommodation) => (
                  <motion.div
                    key={accommodation.id}
                    className={`p-4 rounded-2xl border-2 shadow-sm relative overflow-hidden group ${
                      accommodation.id === 'unnecessary'
                        ? 'border-red-200 bg-gradient-to-br from-red-50 to-red-100 text-red-700'
                        : 'border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100 text-blue-700'
                    }`}
                    variants={itemVariants}
                    whileHover={{ 
                      scale: 1.05,
                      boxShadow: "0 10px 30px rgba(0,0,0,0.1)"
                    }}
                  >
                    <div className="text-3xl mb-2">{accommodation.icon}</div>
                    <div className="text-sm font-medium">{accommodation.name}</div>
                    <div className={`absolute top-2 right-2 w-6 h-6 rounded-full flex items-center justify-center ${
                      accommodation.id === 'unnecessary' ? 'bg-red-500' : 'bg-blue-500'
                    }`}>
                      <div className="w-3 h-3 bg-white rounded-full" />
                    </div>
                  </motion.div>
                ))}
              </motion.div>
            </motion.div>
          )}

          {/* eSIM */}
          {formData.detailedPreferences?.esim && (
            <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6">
              <div className="flex items-center justify-between">
                <div className="flex items-center space-x-3">
                  <div className="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center">
                    <Smartphone className="w-6 h-6 text-white" />
                  </div>
                  <div>
                    <h3 className="text-lg font-semibold text-gray-800">eSIMãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ©ãƒ³</h3>
                    <div className="text-gray-600">
                      <p>1GB Â¥800</p>
                      <p className="text-sm text-purple-600 font-medium">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³å¥‘ç´„ã§3GBç„¡æ–™</p>
                    </div>
                  </div>
                </div>
                <button
                  onClick={() => navigate('/questionnaire/details')}
                  className="text-purple-600 hover:text-purple-700 flex items-center space-x-1"
                >
                  <Edit className="w-4 h-4" />
                  <span>ç·¨é›†</span>
                </button>
              </div>
            </div>
          )}

          {/* OpenAI Data Summary */}
          <motion.div 
            className="bg-gradient-to-r from-gray-50 to-gray-100 rounded-2xl p-6"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 1.0 }}
          >
            <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
              <span className="text-2xl">ğŸ¤–</span>
              AIç”Ÿæˆç”¨ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼
            </h3>
            <div className="bg-white rounded-xl p-4 font-mono text-sm text-gray-700 max-h-40 overflow-y-auto">
              <pre>{JSON.stringify(prepareDataForOpenAI(), null, 2)}</pre>
            </div>
          </motion.div>

          {/* Navigation */}
          <div className="flex justify-between pt-6">
            <motion.button
              onClick={handleBack}
              className="flex items-center space-x-2 px-6 py-3 text-gray-600 hover:text-gray-800 transition-colors rounded-xl hover:bg-gray-100"
              whileHover={{ x: -5, scale: 1.02 }}
              whileTap={{ scale: 0.95 }}
            >
              <ArrowLeft className="w-5 h-5" />
              <span>æˆ»ã‚‹</span>
            </motion.button>
            
            <motion.button
              onClick={handleGeneratePlan}
              disabled={isGenerating}
              className={`flex items-center space-x-2 px-8 py-3 rounded-xl font-medium transition-all relative overflow-hidden ${
                isGenerating
                  ? 'bg-gray-400 text-gray-600 cursor-not-allowed'
                  : 'bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-lg hover:shadow-xl'
              }`}
              whileHover={!isGenerating ? { scale: 1.05, y: -2 } : {}}
              whileTap={!isGenerating ? { scale: 0.98 } : {}}
            >
              {!isGenerating && (
                <motion.div
                  className="absolute inset-0 bg-gradient-to-r from-green-400 to-emerald-400 opacity-20"
                  animate={{ 
                    x: ['-100%', '100%'],
                  }}
                  transition={{
                    duration: 2,
                    repeat: Infinity,
                    ease: "easeInOut"
                  }}
                />
              )}
              
              {isGenerating ? (
                <>
                  <motion.div
                    className="w-5 h-5 border-2 border-gray-300 border-t-gray-600 rounded-full"
                    animate={{ rotate: 360 }}
                    transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                  />
                  <span className="relative z-10">ç”Ÿæˆä¸­...</span>
                </>
              ) : (
                <>
                  <Sparkles className="w-5 h-5 relative z-10" />
                  <span className="relative z-10">æ—…è¡Œãƒ—ãƒ©ãƒ³ç”Ÿæˆ</span>
                  <ArrowRight className="w-5 h-5 relative z-10" />
                </>
              )}
            </motion.button>
          </div>
        </motion.div>

        {/* Progress Indicator */}
        <motion.div
          className="mt-8 flex justify-center"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ duration: 0.8, delay: 1.2 }}
        >
          <div className="flex space-x-2">
            {[0, 1, 2, 3, 4].map((index) => (
              <motion.div
                key={index}
                className="w-3 h-3 bg-green-500 rounded-full"
                initial={{ scale: 0 }}
                animate={{ scale: 1 }}
                transition={{ delay: 1.2 + index * 0.1 }}
                whileHover={{ scale: 1.2 }}
              />
            ))}
          </div>
        </motion.div>
      </motion.div>
    </div>
  );
};

export default Confirmation;
</file>

<file path="src/components/questionnaire/DetailedPreferences.tsx">
import React, { useState } from 'react';
import { motion } from 'framer-motion';
import { useNavigate } from 'react-router-dom';
import { Settings, ArrowRight, ArrowLeft, Plane, Hotel, Smartphone, Car, Check, Plus, Minus, Sparkles, Crown, Gift } from 'lucide-react';
import { useLanguage } from '../../contexts/LanguageContext';

// Premium Plan Button Component
const PremiumPlanButton: React.FC = () => {
  const [isHovered, setIsHovered] = useState(false);
  const [isCharging, setIsCharging] = useState(false);
  const [isClicked, setIsClicked] = useState(false);

  const handleClick = () => {
    setIsCharging(true);
    setIsClicked(true);
    setTimeout(() => {
      setIsCharging(false);
      // Handle premium plan contract logic here
      alert('ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³å¥‘ç´„ç”»é¢ã«ç§»å‹•ã—ã¾ã™ï¼');
    }, 2000);
  };

  return (
    <div className="relative">
      {/* Floating sparkles */}
      <div className="absolute inset-0 pointer-events-none" style={{ width: '300px', height: '120px', left: '-50px', top: '-30px' }}>
        {[...Array(8)].map((_, i) => (
          <motion.div
            key={i}
            className="absolute"
            style={{
              left: `${15 + (i * 10)}%`,
              top: `${20 + (i * 8)}%`,
            }}
            animate={{
              y: [-10, -20, -10],
              opacity: [0.3, 1, 0.3],
              scale: [0.5, 1.2, 0.5],
              rotate: [0, 180, 360],
            }}
            transition={{
              duration: 2 + (i * 0.2),
              repeat: Infinity,
              ease: "easeInOut",
            }}
          >
            <Sparkles className={`w-3 h-3 ${i % 3 === 0 ? 'text-yellow-400' : i % 3 === 1 ? 'text-pink-400' : 'text-purple-400'}`} />
          </motion.div>
        ))}
      </div>

      {/* Energy rings */}
      {isCharging && (
        <div className="absolute inset-0 pointer-events-none">
          {[...Array(3)].map((_, i) => (
            <motion.div
              key={i}
              className="absolute border-2 border-gradient-to-r from-yellow-400 to-pink-400 rounded-full"
              style={{
                width: `${80 + i * 20}px`,
                height: `${80 + i * 20}px`,
                left: '50%',
                top: '50%',
                transform: 'translate(-50%, -50%)',
                borderImage: 'linear-gradient(45deg, #fbbf24, #ec4899) 1',
              }}
              initial={{ scale: 0, opacity: 1 }}
              animate={{
                scale: [0, 1.5],
                opacity: [1, 0]
              }}
              transition={{
                duration: 1.5,
                repeat: Infinity,
                delay: i * 0.3,
                ease: "easeOut"
              }}
            />
          ))}
        </div>
      )}

      {/* Premium Plan Button */}
      <motion.button
        className="relative cursor-pointer group px-8 py-4 rounded-2xl overflow-hidden"
        onHoverStart={() => setIsHovered(true)}
        onHoverEnd={() => setIsHovered(false)}
        onClick={handleClick}
        whileHover={{ scale: 1.05 }}
        whileTap={{ scale: 0.95 }}
        disabled={isCharging}
        style={{
          background: 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 30%, #ec4899 70%, #be185d 100%)',
          boxShadow: isHovered 
            ? '0 20px 40px -12px rgba(251, 191, 36, 0.4), 0 10px 20px -8px rgba(236, 72, 153, 0.3)'
            : '0 10px 25px -12px rgba(0, 0, 0, 0.3)'
        }}
      >
        {/* Enhanced Button Shadow */}
        <motion.div
          className="absolute inset-0 bg-gradient-to-br from-yellow-400/40 to-pink-600/40 rounded-2xl blur-xl"
          animate={{
            scale: isHovered ? 1.2 : 0.8,
            opacity: isHovered ? 0.8 : 0.4,
          }}
          transition={{ duration: 0.4 }}
        />
        
        {/* Magical Glow */}
        <motion.div
          className="absolute inset-0 bg-gradient-to-r from-yellow-300/30 via-pink-300/20 to-purple-300/30 rounded-2xl"
          animate={{
            opacity: isHovered ? 1 : 0.6,
            rotate: [0, 5, -5, 0],
          }}
          transition={{ 
            opacity: { duration: 0.3 },
            rotate: { duration: 3, repeat: Infinity }
          }}
        />

        {/* Button Content */}
        <div className="flex items-center space-x-3 relative z-10">
          {/* Crown Icon with energy effect */}
          <motion.div
            className="relative"
            animate={{
              scale: isHovered ? 1.2 : 1,
              rotate: isCharging ? 360 : 0,
            }}
            transition={{ 
              scale: { duration: 0.3 },
              rotate: { duration: isCharging ? 2 : 0.3, repeat: isCharging ? Infinity : 0 }
            }}
          >
            {/* Energy glow behind crown */}
            <motion.div
              className="absolute inset-0 bg-white/40 rounded-full blur-md"
              animate={{
                scale: isCharging ? [1, 1.5, 1] : 1,
                opacity: isCharging ? [0.4, 0.8, 0.4] : 0.4,
              }}
              transition={{
                duration: 1,
                repeat: isCharging ? Infinity : 0
              }}
            />
            
            <Crown className="w-6 h-6 text-white relative z-10" />
            
            {/* Electric sparks for crown */}
            {isCharging && (
              <>
                {[...Array(4)].map((_, i) => (
                  <motion.div
                    key={i}
                    className="absolute w-1 h-1 bg-yellow-200 rounded-full"
                    style={{
                      left: '50%',
                      top: '50%',
                    }}
                    animate={{
                      x: Math.cos((i * 90) * Math.PI / 180) * 25,
                      y: Math.sin((i * 90) * Math.PI / 180) * 25,
                      scale: [0, 1, 0],
                      opacity: [1, 1, 0],
                    }}
                    transition={{
                      duration: 0.8,
                      repeat: Infinity,
                      delay: i * 0.1,
                      ease: "easeOut"
                    }}
                  />
                ))}
              </>
            )}
          </motion.div>

          {/* Button Text */}
          <motion.div 
            className="flex flex-col"
            animate={{
              scale: isCharging ? [1, 1.05, 1] : 1,
            }}
            transition={{
              duration: 0.5,
              repeat: isCharging ? Infinity : 0
            }}
          >
            <span className="text-white font-bold text-lg tracking-wide">
              ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³
            </span>
            <motion.span 
              className="text-yellow-100 text-xs font-medium"
              animate={{
                opacity: isHovered ? 1 : 0.8,
              }}
            >
              3GBç„¡æ–™ + ç‰¹åˆ¥ç‰¹å…¸
            </motion.span>
          </motion.div>

          {/* Gift Icon */}
          <motion.div
            animate={{
              scale: isHovered ? 1.1 : 1,
              rotate: isCharging ? [0, 10, -10, 0] : 0,
            }}
            transition={{
              scale: { duration: 0.3 },
              rotate: { duration: 1, repeat: isCharging ? Infinity : 0 }
            }}
          >
            <Gift className="w-5 h-5 text-yellow-200" />
          </motion.div>
        </div>

        {/* Loading state */}
        {isCharging && (
          <motion.div
            className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent"
            animate={{
              x: ['-100%', '100%'],
            }}
            transition={{
              duration: 1.5,
              repeat: Infinity,
              ease: "easeInOut"
            }}
          />
        )}

        {/* Inner highlight */}
        <motion.div
          className="absolute inset-1 bg-gradient-to-br from-white/20 to-transparent rounded-xl"
          animate={{
            opacity: isHovered ? 0.8 : 0.4,
          }}
          transition={{ duration: 0.3 }}
        />

        {/* Opening Effect */}
        {isClicked && (
          <motion.div
            className="absolute inset-0 pointer-events-none"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
          >
            {/* Explosion particles */}
            {[...Array(12)].map((_, i) => (
              <motion.div
                key={i}
                className={`absolute w-2 h-2 rounded-full ${
                  i % 3 === 0 ? 'bg-yellow-300' :
                  i % 3 === 1 ? 'bg-pink-300' : 'bg-purple-300'
                }`}
                style={{
                  left: '50%',
                  top: '50%',
                }}
                animate={{
                  x: Math.cos((i * 30) * Math.PI / 180) * (80 + Math.random() * 40),
                  y: Math.sin((i * 30) * Math.PI / 180) * (80 + Math.random() * 40),
                  opacity: [1, 0],
                  scale: [0, 1.2, 0],
                  rotate: [0, 360],
                }}
                transition={{
                  duration: 1.5,
                  ease: "easeOut",
                  delay: i * 0.1,
                }}
              />
            ))}
          </motion.div>
        )}
      </motion.button>
    </div>
  );
};

const DetailedPreferences: React.FC = () => {
  const navigate = useNavigate();
  const { t } = useLanguage();
  const [preferences, setPreferences] = useState({
    transportation: [] as string[],
    accommodation: [] as string[],
    esim: false,
    activities: [] as string[],
    support: [] as string[]
  });
  const [showAllTransportation, setShowAllTransportation] = useState(false);
  const [showAllAccommodation, setShowAllAccommodation] = useState(false);

  const transportationOptions = [
    { id: 'shinkansen', name: 'æ–°å¹¹ç·š', icon: 'ğŸš„', nameEn: 'Shinkansen' },
    { id: 'local-train', name: 'åœ¨æ¥ç·š', icon: 'ğŸšƒ', nameEn: 'Local Train' },
    { id: 'bus', name: 'ãƒã‚¹', icon: 'ğŸšŒ', nameEn: 'Bus' },
    { id: 'rental-car', name: 'ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼', icon: 'ğŸš—', nameEn: 'Rental Car' },
    { id: 'taxi', name: 'ã‚¿ã‚¯ã‚·ãƒ¼', icon: 'ğŸš•', nameEn: 'Taxi' },
    { id: 'bicycle', name: 'è‡ªè»¢è»Š', icon: 'ğŸš²', nameEn: 'Bicycle' },
    { id: 'ferry', name: 'ãƒ•ã‚§ãƒªãƒ¼', icon: 'â›´ï¸', nameEn: 'Ferry' },
    { id: 'airplane', name: 'é£›è¡Œæ©Ÿ', icon: 'âœˆï¸', nameEn: 'Airplane' }
  ];

  const accommodationOptions = [
    { id: 'hotel', name: 'ãƒ›ãƒ†ãƒ«', icon: 'ğŸ¨', nameEn: 'Hotel' },
    { id: 'ryokan', name: 'æ—…é¤¨', icon: 'ğŸ¯', nameEn: 'Ryokan' },
    { id: 'hostel', name: 'ãƒ›ã‚¹ãƒ†ãƒ«', icon: 'ğŸ ', nameEn: 'Hostel' },
    { id: 'airbnb', name: 'Airbnb', icon: 'ğŸ¡', nameEn: 'Airbnb' },
    { id: 'capsule', name: 'ã‚«ãƒ—ã‚»ãƒ«ãƒ›ãƒ†ãƒ«', icon: 'ğŸ›ï¸', nameEn: 'Capsule Hotel' },
    { id: 'minshuku', name: 'æ°‘å®¿', icon: 'ğŸ˜ï¸', nameEn: 'Minshuku' },
    { id: 'luxury-resort', name: 'é«˜ç´šãƒªã‚¾ãƒ¼ãƒˆ', icon: 'ğŸ–ï¸', nameEn: 'Luxury Resort' },
    { id: 'camping', name: 'ã‚­ãƒ£ãƒ³ãƒ—', icon: 'â›º', nameEn: 'Camping' },
    { id: 'unnecessary', name: 'å¿…è¦ãªã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³', icon: 'âŒ', nameEn: 'Not Needed' }
  ];

  const displayedTransportation = showAllTransportation ? transportationOptions : transportationOptions.slice(0, 6);
  const displayedAccommodation = showAllAccommodation ? accommodationOptions : accommodationOptions.slice(0, 6);
  
  const remainingTransportation = transportationOptions.length - 6;
  const remainingAccommodation = accommodationOptions.length - 6;

  const toggleOption = (category: keyof typeof preferences, optionId: string) => {
    setPreferences(prev => ({
      ...prev,
      [category]: prev[category].includes(optionId)
        ? prev[category].filter(id => id !== optionId)
        : [...prev[category], optionId]
    }));
  };

  const handleNext = () => {
    console.log('ğŸ” DetailedPreferences handleNext called');
    console.log('ğŸš— Transportation:', preferences.transportation);
    console.log('ğŸ¨ Accommodation:', preferences.accommodation);
    console.log('ğŸ“± eSIM:', preferences.esim);
    
    localStorage.setItem('trippin-detailed-preferences', JSON.stringify(preferences));
    console.log('ğŸ’¾ DetailedPreferences saved to localStorage');
    console.log('ğŸš€ About to navigate to: /questionnaire/confirmation');
    
    navigate('/questionnaire/confirmation');
    console.log('âœ… Navigation executed');
  };

  const handleBack = () => {
    navigate('/questionnaire/style');
  };

  // Animation variants for staggered children
  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.1
      }
    }
  };

  const itemVariants = {
    hidden: { y: 20, opacity: 0 },
    visible: {
      y: 0,
      opacity: 1,
      transition: {
        type: "spring",
        damping: 12,
        stiffness: 200
      }
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center p-6 bg-gradient-to-br from-purple-50 via-indigo-50 to-blue-50 relative overflow-hidden">
      {/* Animated background elements */}
      <div className="absolute inset-0 overflow-hidden">
        <motion.div
          className="absolute top-10 left-10 w-72 h-72 bg-gradient-to-r from-purple-300 to-indigo-300 rounded-full opacity-20 blur-3xl"
          animate={{
            x: [0, 100, 0],
            y: [0, -50, 0],
          }}
          transition={{
            duration: 20,
            repeat: Infinity,
            ease: "easeInOut"
          }}
        />
        <motion.div
          className="absolute top-1/2 right-10 w-96 h-96 bg-gradient-to-r from-blue-300 to-cyan-300 rounded-full opacity-15 blur-3xl"
          animate={{
            x: [0, -80, 0],
            y: [0, 60, 0],
          }}
          transition={{
            duration: 25,
            repeat: Infinity,
            ease: "easeInOut"
          }}
        />
        <motion.div
          className="absolute bottom-10 left-1/3 w-64 h-64 bg-gradient-to-r from-indigo-300 to-purple-300 rounded-full opacity-10 blur-3xl"
          animate={{
            scale: [1, 1.2, 1],
            rotate: [0, 180, 360],
          }}
          transition={{
            duration: 30,
            repeat: Infinity,
            ease: "easeInOut"
          }}
        />
      </div>

      <motion.div
        className="max-w-4xl w-full relative z-10"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.8 }}
      >
        {/* Header */}
        <div className="text-center mb-8">
          <motion.div
            className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-full mb-6 relative shadow-xl"
            initial={{ scale: 0, rotate: -180 }}
            animate={{ scale: 1, rotate: 0 }}
            transition={{ 
              type: "spring",
              damping: 10,
              stiffness: 200,
              delay: 0.2 
            }}
            whileHover={{ 
              scale: 1.1,
              boxShadow: "0 20px 40px rgba(124, 58, 237, 0.3)"
            }}
          >
            <Settings className="w-8 h-8 text-white" />
            <motion.div
              className="absolute -top-2 -right-2 w-6 h-6 bg-cyan-400 rounded-full flex items-center justify-center"
              animate={{ 
                rotate: [0, 360],
                scale: [1, 1.2, 1]
              }}
              transition={{
                duration: 3,
                repeat: Infinity,
                ease: "easeInOut"
              }}
            >
              <Sparkles className="w-3 h-3 text-white" />
            </motion.div>
          </motion.div>
          
          <motion.h1
            className="text-3xl md:text-4xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent mb-4"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.8, delay: 0.3 }}
          >
            {t('questionnaire.details')}
          </motion.h1>
        </div>

        <motion.div
          className="bg-white/80 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20"
          initial={{ opacity: 0, y: 30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8, delay: 0.5 }}
        >
          {/* Transportation */}
          <div className="mb-8">
            <motion.h3 
              className="text-xl font-semibold text-gray-800 mb-4"
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.6 }}
            >
              äº¤é€šæ‰‹æ®µ
            </motion.h3>
            
            <motion.div 
              className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6"
              variants={containerVariants}
              initial="hidden"
              animate="visible"
            >
              {displayedTransportation.map((option, index) => (
                <motion.button
                  key={option.id}
                  onClick={() => toggleOption('transportation', option.id)}
                  className={`p-4 rounded-2xl border-2 transition-all duration-300 relative overflow-hidden group ${
                    preferences.transportation.includes(option.id)
                      ? 'border-purple-500 bg-gradient-to-br from-purple-50 to-purple-100 text-purple-700 shadow-lg'
                      : 'border-gray-200 hover:border-purple-300 hover:bg-gradient-to-br hover:from-purple-50 hover:to-white bg-white/50 backdrop-blur-sm'
                  }`}
                  variants={itemVariants}
                  whileHover={{ 
                    scale: 1.05,
                    boxShadow: "0 10px 30px rgba(0,0,0,0.1)"
                  }}
                  whileTap={{ scale: 0.95 }}
                >
                  {/* Animated background effect */}
                  <motion.div
                    className="absolute inset-0 bg-gradient-to-r from-purple-400 to-indigo-400 opacity-0 group-hover:opacity-10 transition-opacity duration-300"
                    initial={false}
                    animate={preferences.transportation.includes(option.id) ? { opacity: 0.1 } : { opacity: 0 }}
                  />
                  
                  <motion.div 
                    className="text-3xl mb-2 relative z-10"
                    animate={preferences.transportation.includes(option.id) ? { scale: [1, 1.2, 1] } : { scale: 1 }}
                    transition={{ duration: 0.3 }}
                  >
                    {option.icon}
                  </motion.div>
                  <div className="text-sm font-medium relative z-10">{option.name}</div>
                  
                  {/* Selected indicator */}
                  {preferences.transportation.includes(option.id) && (
                    <motion.div
                      className="absolute top-2 right-2 w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center"
                      initial={{ scale: 0, rotate: -180 }}
                      animate={{ scale: 1, rotate: 0 }}
                      transition={{ type: "spring", damping: 15 }}
                    >
                      <motion.div
                        className="w-3 h-3 bg-white rounded-full"
                        animate={{ scale: [1, 1.2, 1] }}
                        transition={{ duration: 2, repeat: Infinity }}
                      />
                    </motion.div>
                  )}
                </motion.button>
              ))}
            </motion.div>
            
            {remainingTransportation > 0 && (
              <div className="text-center">
                <motion.button
                  onClick={() => setShowAllTransportation(!showAllTransportation)}
                  className="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white rounded-full font-medium transition-all duration-300 shadow-lg hover:shadow-xl"
                  whileHover={{ scale: 1.05, y: -2 }}
                  whileTap={{ scale: 0.95 }}
                >
                  {showAllTransportation ? (
                    <>
                      <Minus className="w-4 h-4" />
                      {t('common.showLess')}
                    </>
                  ) : (
                    <>
                      <Plus className="w-4 h-4" />
                      {t('common.showMore').replace('{count}', remainingTransportation.toString())}
                    </>
                  )}
                </motion.button>
              </div>
            )}
          </div>

          {/* Accommodation */}
          <div className="mb-8">
            <motion.h3 
              className="text-xl font-semibold text-gray-800 mb-4"
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.7 }}
            >
              å®¿æ³Šæ–½è¨­
            </motion.h3>
            
            <motion.div 
              className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6"
              variants={containerVariants}
              initial="hidden"
              animate="visible"
            >
              {displayedAccommodation.map((option, index) => (
                <motion.button
                  key={option.id}
                  onClick={() => toggleOption('accommodation', option.id)}
                  className={`p-4 rounded-2xl border-2 transition-all duration-300 relative overflow-hidden group ${
                    preferences.accommodation.includes(option.id)
                      ? option.id === 'unnecessary' 
                        ? 'border-red-500 bg-gradient-to-br from-red-50 to-red-100 text-red-700 shadow-lg'
                        : 'border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100 text-blue-700 shadow-lg'
                      : 'border-gray-200 hover:border-blue-300 hover:bg-gradient-to-br hover:from-blue-50 hover:to-white bg-white/50 backdrop-blur-sm'
                  }`}
                  variants={itemVariants}
                  whileHover={{ 
                    scale: 1.05,
                    boxShadow: "0 10px 30px rgba(0,0,0,0.1)"
                  }}
                  whileTap={{ scale: 0.95 }}
                >
                  {/* Animated background effect */}
                  <motion.div
                    className={`absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-300 ${
                      option.id === 'unnecessary' 
                        ? 'bg-gradient-to-r from-red-400 to-pink-400'
                        : 'bg-gradient-to-r from-blue-400 to-cyan-400'
                    }`}
                    initial={false}
                    animate={preferences.accommodation.includes(option.id) ? { opacity: 0.1 } : { opacity: 0 }}
                  />
                  
                  <motion.div 
                    className="text-3xl mb-2 relative z-10"
                    animate={preferences.accommodation.includes(option.id) ? { scale: [1, 1.2, 1] } : { scale: 1 }}
                    transition={{ duration: 0.3 }}
                  >
                    {option.icon}
                  </motion.div>
                  <div className="text-sm font-medium relative z-10">{option.name}</div>
                  
                  {/* Selected indicator */}
                  {preferences.accommodation.includes(option.id) && (
                    <motion.div
                      className={`absolute top-2 right-2 w-6 h-6 rounded-full flex items-center justify-center ${
                        option.id === 'unnecessary' ? 'bg-red-500' : 'bg-blue-500'
                      }`}
                      initial={{ scale: 0, rotate: -180 }}
                      animate={{ scale: 1, rotate: 0 }}
                      transition={{ type: "spring", damping: 15 }}
                    >
                      <motion.div
                        className="w-3 h-3 bg-white rounded-full"
                        animate={{ scale: [1, 1.2, 1] }}
                        transition={{ duration: 2, repeat: Infinity }}
                      />
                    </motion.div>
                  )}
                </motion.button>
              ))}
            </motion.div>
            
            {remainingAccommodation > 0 && (
              <div className="text-center">
                <motion.button
                  onClick={() => setShowAllAccommodation(!showAllAccommodation)}
                  className="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white rounded-full font-medium transition-all duration-300 shadow-lg hover:shadow-xl"
                  whileHover={{ scale: 1.05, y: -2 }}
                  whileTap={{ scale: 0.95 }}
                >
                  {showAllAccommodation ? (
                    <>
                      <Minus className="w-4 h-4" />
                      {t('common.showLess')}
                    </>
                  ) : (
                    <>
                      <Plus className="w-4 h-4" />
                      {t('common.showMore').replace('{count}', remainingAccommodation.toString())}
                    </>
                  )}
                </motion.button>
              </div>
            )}
          </div>

          {/* Quick Actions */}
          <motion.div 
            className="mb-8 bg-gradient-to-r from-gray-50 to-gray-100 rounded-2xl p-4"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.8 }}
          >
            <div className="flex justify-between items-center">
              <motion.button
                onClick={() => setPreferences(prev => ({
                  ...prev,
                  transportation: transportationOptions.map(t => t.id),
                  accommodation: accommodationOptions.map(a => a.id)
                }))}
                className="flex items-center gap-2 px-4 py-2 text-sm bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-full transition-all duration-300 font-medium"
                whileHover={{ scale: 1.05 }}
                whileTap={{ scale: 0.95 }}
              >
                <Plus className="w-4 h-4" />
                ã™ã¹ã¦é¸æŠ
              </motion.button>
              
              <div className="text-sm text-gray-600 font-medium bg-white px-4 py-2 rounded-full shadow-sm">
                {preferences.transportation.length + preferences.accommodation.length} / {transportationOptions.length + accommodationOptions.length}
              </div>
              
              <motion.button
                onClick={() => setPreferences(prev => ({
                  ...prev,
                  transportation: [],
                  accommodation: []
                }))}
                className="flex items-center gap-2 px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full transition-all duration-300 font-medium"
                whileHover={{ scale: 1.05 }}
                whileTap={{ scale: 0.95 }}
              >
                <Minus className="w-4 h-4" />
                ã™ã¹ã¦è§£é™¤
              </motion.button>
            </div>
          </motion.div>

          {/* eSIM */}
          <motion.div 
            className="mb-8"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.9 }}
          >
            <h3 className="text-xl font-semibold text-gray-800 mb-4">
              eSIMãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ©ãƒ³
            </h3>
            <motion.button
              onClick={() => setPreferences(prev => ({ ...prev, esim: !prev.esim }))}
              className={`w-full p-6 rounded-2xl border-2 transition-all duration-300 relative overflow-hidden group ${
                preferences.esim
                  ? 'border-purple-500 bg-gradient-to-br from-purple-50 to-purple-100'
                  : 'border-gray-200 hover:border-purple-300 hover:bg-gradient-to-br hover:from-purple-50 hover:to-white bg-white/50 backdrop-blur-sm'
              }`}
              whileHover={{ scale: 1.01 }}
              whileTap={{ scale: 0.99 }}
            >
              {/* Animated background effect */}
              <motion.div
                className="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-400 opacity-0 group-hover:opacity-10 transition-opacity duration-300"
                initial={false}
                animate={preferences.esim ? { opacity: 0.1 } : { opacity: 0 }}
              />
              
              <div className="flex items-center justify-between relative z-10">
                <div className="flex items-center space-x-4">
                  <motion.div
                    animate={preferences.esim ? { scale: [1, 1.1, 1] } : { scale: 1 }}
                    transition={{ duration: 0.3 }}
                  >
                    <Smartphone className="w-8 h-8 text-purple-600" />
                  </motion.div>
                  <div className="text-left">
                    <div className="font-semibold text-gray-800">eSIMãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ©ãƒ³</div>
                    <div className="text-sm text-gray-600">
                      <p>1GB Â¥800</p>
                      <p className="text-purple-600 font-medium">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³å¥‘ç´„ã§3GBç„¡æ–™</p>
                    </div>
                  </div>
                </div>
                <motion.div 
                  className={`w-8 h-8 rounded-full border-2 transition-all flex items-center justify-center ${
                    preferences.esim
                      ? 'border-purple-500 bg-purple-500'
                      : 'border-gray-300'
                  }`}
                  animate={preferences.esim ? { scale: [1, 1.1, 1] } : { scale: 1 }}
                  transition={{ duration: 0.3 }}
                >
                  {preferences.esim && (
                    <motion.div
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      transition={{ type: "spring", damping: 15 }}
                    >
                      <Check className="w-5 h-5 text-white" />
                    </motion.div>
                  )}
                </motion.div>
              </div>
            </motion.button>

            {/* Premium Plan Contract Button */}
            <motion.div
              className="mt-6 flex justify-center"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 1.0 }}
            >
              <PremiumPlanButton />
            </motion.div>
          </motion.div>

          {/* Navigation */}
          <div className="flex justify-between">
            <motion.button
              onClick={handleBack}
              className="flex items-center space-x-2 px-6 py-3 text-gray-600 hover:text-gray-800 transition-colors rounded-xl hover:bg-gray-100"
              whileHover={{ x: -5, scale: 1.02 }}
              whileTap={{ scale: 0.95 }}
            >
              <ArrowLeft className="w-5 h-5" />
              <span>{t('common.back')}</span>
            </motion.button>
            
            <motion.button
              onClick={handleNext}
              className="flex items-center space-x-2 px-8 py-3 rounded-xl font-medium transition-all relative overflow-hidden bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl"
              whileHover={{ scale: 1.05, y: -2 }}
              whileTap={{ scale: 0.98 }}
            >
              <motion.div
                className="absolute inset-0 bg-gradient-to-r from-purple-400 to-indigo-400 opacity-20"
                animate={{ 
                  x: ['-100%', '100%'],
                }}
                transition={{
                  duration: 2,
                  repeat: Infinity,
                  ease: "easeInOut"
                }}
              />
              <span className="relative z-10">{t('common.next')}</span>
              <ArrowRight className="w-5 h-5 relative z-10" />
            </motion.button>
          </div>
        </motion.div>

        {/* Progress Indicator */}
        <motion.div
          className="mt-8 flex justify-center"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ duration: 0.8, delay: 1 }}
        >
          <div className="flex space-x-2">
            {[0, 1, 2, 3, 4].map((index) => (
              <motion.div
                key={index}
                className={`w-3 h-3 rounded-full transition-all duration-300 ${
                  index < 4 ? 'bg-purple-500' : 'bg-gray-300'
                }`}
                initial={{ scale: 0 }}
                animate={{ scale: 1 }}
                transition={{ delay: 1 + index * 0.1 }}
                whileHover={{ scale: 1.2 }}
              />
            ))}
          </div>
        </motion.div>
      </motion.div>
    </div>
  );
};

export default DetailedPreferences;
</file>

</files>
